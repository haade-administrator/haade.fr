<!DOCTYPE html><html lang="fr-FR"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="icon" href="/assets/images/logo.png"><title>Template - Créer une moyenne sur entités - Haade.fr</title><meta name="description" content="mini tutos sur les templates dans home assistant, comment créer une moyenne de l’état de plusieurs entitées."><meta name="author" content="Nico"><link rel="canonical" href="https://haade.fr/fr/blog/home-assistant-Template-faire-des-moyennes-de-plusieurs-entites"><link rel="alternate" hreflang="en" href="https://haade.fr/en/blog/home-assistant-Template-make-averages-of-multiple-entities"/><link rel="alternate" hreflang="fr" href="https://haade.fr/fr/blog/home-assistant-Template-faire-des-moyennes-de-plusieurs-entites"/><meta property="og:locale" content="fr-FR"><meta property="og:type" content="article"><meta property="og:title" content="Template - Créer une moyenne sur entités"><meta property="og:description" content="mini tutos sur les templates dans home assistant, comment créer une moyenne de l’état de plusieurs entitées."><meta property="og:url" content="https://haade.fr/fr/blog/home-assistant-Template-faire-des-moyennes-de-plusieurs-entites"><meta property="og:site_name" content="Haade.fr"><meta property="og:image" content="https://haade.fr/creer-moyenne-etat-entite-template-home-assistant.png"><meta property="article:author" content="Nico"><meta property="article:published_time" content="2024-04-11T12:30:00+02:00"> <script type="application/ld+json"> { "@context": "https://schema.org", "@type": "BlogPosting", "url": "https://haade.fr/fr/blog/home-assistant-Template-faire-des-moyennes-de-plusieurs-entites", "name": "Template - Créer une moyenne sur entités", "headline": "Template - Créer une moyenne sur entités", "keywords": "Haade-lab,Mini-tutos", "description": "mini tutos sur les templates dans home assistant, comment créer une moyenne de l'état de plusieurs entitées.", "articleBody": "Pour notre premier tuto template, je te propose de créer des moyennes à partir de l’état des valeurs des entités ( sensor ). Dans mons cas j’ai besoin de faire une moyenne de deux valeurs concernant la téléinformation heure creuse/heure pleine afin de faire remonter une seule valeur commune. De plus elle est exprimée par défaut en Wh et j’aimerai la transformer en KWh. Tu va voir que Liquid/Jinja ce n’est pas très compliqué !\n\nPrérequis\n\nHome Assistant d’installé\n\n\n \n\n \n \n \n Box HomeAssistant Green\n Par Nabu Casa\n Box Home Assistant Green en vente chez domadoo à moins de 100€\n \n \n \n \n Achetez sur Domadoo\n \n \n \n \n \n \n \n\n\nTemplate et entité\n\nPour créer un template rien de plus simple rends-tois dans home assistant\n\n\n Paramètres/entrées/créer une entrée/template/Modéliser un capteur\n\n\nrécupère les valeurs\n\n\n\nrelève le nom de l’entité\n\n\n\nExplications du code\n\nLe module de téléinfo que j’utilises ainsi que mon abonnement font remonter l’information heure-creuse/heure-pleine, pour raison personnelle je paie exactement la même chose quelque soit le tarif.\n\nOn enregistre le premier état sous hc\n\n{% set hc = states('sensor.teleinfo_hchc') | float %}\n\nOn enregistre le second état sous hp\n\n{% set hp = states('sensor.teleinfo_hchp') | float %}\n\nOn affiche la valeur hc + hp le tout divisé par 2 et ensuite divisé par 1000 avec un arrondis de 2 après la virgule\n\n{{ ((hc + hp) / 2 / 1000) | round(2, default=0) }}\n\nRésultat du code\n\n{% set hc = states(&#39;sensor.teleinfo_hchc&#39;) | float %}\n{% set hp = states(&#39;sensor.teleinfo_hchp&#39;) | float %}\n{{ ((hc + hp) / 2 / 1000) | round(2, default=0) }}\n\nExplication animée\n\n\n La classe de l’appareil et la classe d’état s’afficheront en rouge s’il y a une discordance avec l’entité choisi, c’est plutôt bien fait.\n\n\n\n\n\n Tu pourras vérifier en direct les données remontées avant la validation du template.\n\n", "datePublished": "2024-04-11 12:30:00 +0200", "dateModified": "2024-04-11 12:30:00 +0200", "inLanguage": "fr-FR", "author": { "@type": "Person", "name": "Nico", "alternateName": "Nico", "description": "Membre fondateur du site Haade, voilà plus de 10 ans que je suis passionné de domotique, informatique et électronique. J'essaie à travers ce blog d'aider d'autres internautes à s'expérimenter en domotique, à trouver des tutos ludiques, bref à évoluer.", "url": "/fr/auteur-nico/","image": "https://haade.fr/nico.png","email": "nico@haade.fr" }, "publisher": { "@type": "Organization", "name": "Haade.fr", "url": "https://haade.fr", "logo": { "@type": "ImageObject", "width": 250, "height": 63, "url": "https://haade.fr/assets/images/logo.png" } }, "mainEntityOfPage": { "@type": "WebPage", "@id": "https://haade.fr/fr/blog/home-assistant-Template-faire-des-moyennes-de-plusieurs-entites" }, "image": { "@type": "ImageObject", "width": 250, "height": 94, "url": "https://haade.fr/creer-moyenne-etat-entite-template-home-assistant.png" } } </script><link href="/assets/css/theme.css?v=1760930163159472047" media="screen, projection, print" rel="stylesheet"> <script data-goatcounter="https://haade.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script><link rel="preload" href="/assets/fonts/montserrat/Montserrat-VariableFont_wght.woff2" as="font" crossorigin><link rel="preload" href="/assets/fonts/icomoon/icomoon.woff2?4fpajq" as="font" crossorigin><link rel="shortcut icon" type="image/x-icon" href="/assets/images/favicon.ico" ><link rel="shortcut icon" type="image/png" href="/assets/images/favicon.png" ><header><div class="firstnavbar"><div class="links"> <a href="/">Accueil</a> <a href="/fr/rgpd-politique-de-confidentialite/">RGPD</a> <a href="/fr/contact/">Contact</a><div class="sl-nav"> langue:<ul><li><b>Francais</b> <i class="ico angle-down-solid triangle-arrow trrow" aria-hidden="true"></i><div class="triangle"></div><ul class="show-flags"><li class="current"><a href="/fr/blog/home-assistant-Template-faire-des-moyennes-de-plusieurs-entites"><i class="sl-flag fix flag-fr"><div id="Francais"></div></i><span class="active">Francais</span></a><li><a href="/en/blog/home-assistant-Template-make-averages-of-multiple-entities"><i class="sl-flag fix flag-england"><div id="English"></div></i><span class="active">English</span></a></ul></ul></div></div><div class="social-firstnav"> <a href="https://github.com/haade-administrator/haade.fr/discussions" target="_blank" alt="github discussion link" aria-label="Continue la discussion sur le forum github"><i class="icob github" width="1em" height="1em" aria-hidden="true" title="github discussion"></i></a> <a href="https://www.youtube.com/channel/UCcXJ1ZsjEvQxuWJy7gH-A6w/?sub_confirmation=1" onclick="window.open(this.href, 'width=550,height=435');return false;" aria-label="Abonne toi à notre chaine youtube"><i class="icob youtube" width="1em" height="1em" target="_blank" alt="youtube" aria-hidden="true" title="youtube"></i></a> <a href="https://discord.gg/FaK6MuZ2" onclick="window.open(this.href, 'width=550,height=435');return false;" aria-label="Invitation sur notre réseau Discord"><i class="icob discord" width="1em" height="1em" target="_blank" alt="discord" aria-hidden="true" title="discord"></i></a> <a href="/fr/feed.xml" target="_blank" alt="feed rss" aria-label="partage le flux rss avec tes amis"><i class="icob rss" width="1em" height="1em" aria-hidden="true" title="feed rss haade"></i></a></div></div><div class="secondheader"> <a class="navbar-brand" href="/"><picture> <source sizes="(max-width: 524px) 150px, 250px" srcset="https://haade.fr/assets/images/generated/logo-150-379587352.webp 150w, https://haade.fr/assets/images/generated/logo-250-379587352.webp 250w" type="image/webp"> <source sizes="(max-width: 524px) 150px, 250px" srcset="https://haade.fr/assets/images/generated/logo-150-64f85a78e.png 150w, https://haade.fr/assets/images/generated/logo-250-64f85a78e.png 250w" type="image/png"> <img id="logoIImage" src="https://haade.fr/assets/images/generated/logo-250-64f85a78e.png" alt="Logo officiel du site domotique Haade" width="250" height="94"> </picture> </a><p class="sitetag"> Home Assistance Alsace domotique & électronique.</p></div><nav id="nav"><div class="navbar"> <i class='icos bars-solid'></i><div class="nav-links"><div class="sidebar-logo"> <span class="logo-name">H2Ade</span> <i class='icos times-solid'></i></div><ul class="links"><li><a href="/">Accueil<span class="badge badge-light tags">162</span></a><li> <a href="https://haade.fr/fr/categorie/domotique">Domotique</a> <i class="icos angle-down-solid htmlcss-arrow-automation arrow"></i><ul class="htmlCss-sub-menu-automation sub-menu"><li><a href="/fr/categorie/securite">Sécurité</a><li class="more"> <span><a href="/fr/categorie/haade-lab">Tutos</a> <i class='icos angle-right-solid arrow more-arrow-automation'></i> </span><ul class="more-sub-menu-automation sub-menu"><li><a href="/fr/categorie/mini-tutos">Mini-tutos</a><li><a href="/fr/categorie/videos">Vidéos</a><li><a href="/fr/categorie/home-assistant">Home-Assistant</a><li><a href="/fr/categorie/jeedom">Jeedom</a></ul></ul><li><a href="/fr/categorie/news">News</a><li><a href="/fr/categorie/tests">Tests</a><li><a href="/fr/auteurs">Contributeurs<span class="badge badge-primary">News</span></a><li><a target="_blank" href="https://github.com/haade-administrator/haade.fr/discussions">Forum</a><li><a href="/fr/categorie-produit/boutique">Boutique</a> <i class="icos angle-down-solid htmlcss-arrow-shop arrow"></i><ul class="htmlCss-sub-menu-shop sub-menu"><li class="more"> <span><a href="#">Marque</a> <i class='icos angle-right-solid arrow more-arrow-brand'></i> </span><ul class="more-sub-menu-brand sub-menu"><li><a href="/fr/categorie-produit/jeedom">Jeedom</a><li><a href="/fr/categorie-produit/moes">Moes</a><li><a href="/fr/categorie-produit/neo-coolcam">Neo-Coolcam</a><li><a href="/fr/categorie-produit/nodon">Nodon</a><li><a href="/fr/categorie-produit/raspberry-pi">Raspberry Pi</a><li><a href="/fr/categorie-produit/shelly">Shelly</a><li><a href="/fr/categorie-produit/sonoff">Sonoff</a><li><a href="/fr/categorie-produit/tedee">Tedee</a><li><a href="/fr/categorie-produit/xiaomi">Xiaomi</a><li><a href="/fr/categorie-produit/zemismart">Zemismart</a><li><a href="/fr/categorie-produit/zooz">Zooz</a></ul><li class="more"> <span><a href="#">Protocole</a> <i class='ico angle-right-solid arrow more-arrow-protocol'></i> </span><ul class="more-sub-menu-protocol sub-menu"><li><a href="/fr/categorie-produit/bluetooth">Bluetooth</a><li><a href="/fr/categorie-produit/esp">Esp 32/8266</a><li><a href="/fr/categorie-produit/matter">Matter</a><li><a href="/fr/categorie-produit/wifi">Wifi</a><li><a href="/fr/categorie-produit/zigbee">Zigbee</a><li><a href="/fr/categorie-produit/zwave">Z-wave</a></ul></ul><li><div class="sl-nav"> langue:<ul><li><b>Francais</b> <i class="ico angle-down-solid triangle-arrow trrow" aria-hidden="true"></i><div class="triangle"></div><ul class="show-flags"><li class="current"><a href="/fr/blog/home-assistant-Template-faire-des-moyennes-de-plusieurs-entites"><i class="sl-flag fix flag-fr"><div id="Francais"></div></i><span class="active">Francais</span></a><li><a href="/en/blog/home-assistant-Template-make-averages-of-multiple-entities"><i class="sl-flag fix flag-england"><div id="English"></div></i><span class="active">English</span></a></ul></ul></div></ul></div><script src="/assets/js/lunr.min.js?v=a944ea77ca394dff9a667d5aea56f0e9" type="text/javascript"></script><div class="search-box"> <i class='icos search-solid'></i><div class="input-box"> <form onSubmit="return lunr_search(document.getElementById('lunrsearch').value);" class="search-form" role="search"> <input autocomplete="on" id="lunrsearch" class="search-input" name="q" maxlength="200" placeholder="Recherche..." type="search" value=""> <input class="search-action" type="submit" value="Ok"> </form></div><div id="lunrsearchresults"><ul></ul></div></div></div></nav></header><div class="site-content"><div class="container"><div class="main-content"> <script> var addViews = ""; var addViewsValue = parseInt(addViews); var r = new XMLHttpRequest(); r.addEventListener('load', function() { var visits = parseInt(JSON.parse(this.responseText).count.replace(/\s/g, '')); var totalVisits = visits; if (!isNaN(addViewsValue)) { totalVisits += addViewsValue; } document.getElementById('visits').innerText = totalVisits; }); r.open('GET', 'https://haade.goatcounter.com/counter/' + encodeURIComponent(location.pathname) + '.json'); r.send(); </script><div class="entry-header"><nav class="ariane"><ol class="arianefil" itemscope itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"> <a itemprop="item" href="https://haade.fr/"><span itemprop="name">Accueil</span></a><meta itemprop="position" content="1"><li><span class="prompt">&nbsp; > &nbsp;</span><li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" href="https://haade.fr/fr/categorie/haade-lab"><span itemprop="name">Haade-lab</span></a><meta itemprop="position" content="2"><li><span class="prompt">&nbsp; > &nbsp;</span>Template - Créer une moyenne sur entités</ol></nav><h1 class="posttitle">Template - Créer une moyenne sur entités</h1><div class="d-flex align-items-start mt-4"><div class="authorpost"> <a href="/fr/auteur-nico"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-60-5d88b8595.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-60-c8508425c.png 1.0x" type="image/png"> <img class="author-thumb" itemprop="image" width="60" height="60" src="https://haade.fr/assets/images/generated/nico-60-c8508425c.png" alt="Nico"> </picture> </a> Écris par <a href="/fr/auteur-nico"><b>Nico</b></a></div><div class="readingpost">&nbsp;<i class="icos calendar-check" width="1em" height="1em"></i> <span class="post-date"><time class="post-date" datetime="11-04-2024">11 avril 2024 &nbsp; </time></span> <span><span class="reading-time" title="Temps de Lecture estimé"> <i class="icos history" width="1em" height="1em"></i> <strong> 2 min</strong> de lecture </span> </span><p><i class="icos eye-solid" width="1em" height="1em"></i> Cet Article a été vu <span id="visits" style="font-weight:bold">...</span> fois</p></div></div></div><div class="entry-featured-image"><picture> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) 800px, (min-width: 1025px) 940px, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-300-0e6342f7a.webp 300w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-400-0e6342f7a.webp 400w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-500-0e6342f7a.webp 500w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-600-0e6342f7a.webp 600w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-700-0e6342f7a.webp 700w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-800-0e6342f7a.webp 800w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-900-0e6342f7a.webp 900w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-940-0e6342f7a.webp 940w" type="image/webp"> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) 800px, (min-width: 1025px) 940px, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-300-0e6342f7a.png 300w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-400-0e6342f7a.png 400w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-500-0e6342f7a.png 500w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-600-0e6342f7a.png 600w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-700-0e6342f7a.png 700w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-800-0e6342f7a.png 800w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-900-0e6342f7a.png 900w, https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-940-0e6342f7a.png 940w" type="image/png"> <img class="lazyload featured-image-post" width="940" height="529" itemprop="image" src="https://haade.fr/assets/images/generated/posts/119/creer-moyenne-etat-entite-template-home-assistant-940-0e6342f7a.png" alt="Template - Créer une moyenne sur entités"> </picture></div><div class="article-post"><p><em></em></p><div class="toc mt-4 mb-4 lead"><h3 class="font-weight-bold">Sommaire</h3><ul class="table_of"><li class="toc"><a href="#prérequis" class="toc_anchor">Prérequis</a><li class="toc"><a href="#template-et-entité" class="toc_anchor">Template et entité</a><ul class="toc_sub"><li class="toc"><a href="#récupère-les-valeurs" class="toc_anchor">récupère les valeurs</a><li class="toc"><a href="#relève-le-nom-de-lentité" class="toc_anchor">relève le nom de l’entité</a></ul><li class="toc"><a href="#explications-du-code" class="toc_anchor">Explications du code</a><ul class="toc_sub"><li class="toc"><a href="#résultat-du-code" class="toc_anchor">Résultat du code</a><li class="toc"><a href="#explication-animée" class="toc_anchor">Explication animée</a></ul></ul></div><div class="content-post"><p>Pour notre premier tuto template, je te propose <strong>de créer des moyennes à partir de l’état des valeurs des entités</strong> ( sensor ). Dans mons cas j’ai besoin de faire une moyenne de deux valeurs concernant la téléinformation heure creuse/heure pleine afin de faire remonter une seule valeur commune. De plus elle est exprimée par défaut en Wh et j’aimerai la transformer en KWh. Tu va voir que <code>Liquid/Jinja</code> <strong>ce n’est pas très compliqué !</strong></p><h2 id="prérequis">Prérequis</h2><p><strong>Home Assistant d’installé</strong></p><div class="embedproduct"><div class="embedproduct-picture"><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/119/Home-Assistant-Green-240-584f1743f.webp 240w, https://haade.fr/assets/images/generated/posts/119/Home-Assistant-Green-250-584f1743f.webp 250w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/119/Home-Assistant-Green-240-584f1743f.png 240w, https://haade.fr/assets/images/generated/posts/119/Home-Assistant-Green-250-584f1743f.png 250w" type="image/png" /><img class="pictinpost lazyload" width="250" height="250" src="https://haade.fr/assets/images/generated/posts/119/Home-Assistant-Green-240-584f1743f.png" alt="Box Home Assistant Green en vente chez domadoo à moins de 100€" /></picture></div><div class="text"><div class="embedproduct-info"><h2 class="no_toc">Box HomeAssistant Green</h2><h3 class="no_toc">Par Nabu Casa</h3><p>Box Home Assistant Green en vente chez domadoo à moins de 100€</p></div><div class="embedproduct-price"><div class="embedaffiliate"> <span class="dombutton" role="button"><a href="https://www.domadoo.fr/fr/produits-compatibles-home-assistant/7046-nabu-casa-box-domotique-home-assistant-green-0794677011758.html?domid=39" target="_blank" rel="nofollow noopener"><img src="/assets/images/domadoo.png" width="20" height="20" class="lazyload" alt="domadoo logo" /> Achetez sur Domadoo</a></span></div></div></div></div><h2 id="template-et-entité">Template et entité</h2><p>Pour créer un template rien de plus simple rends-tois dans home assistant</p><blockquote><p><strong>Paramètres/entrées/créer une entrée/template/Modéliser un capteur</strong></p></blockquote><h3 id="récupère-les-valeurs">récupère les valeurs</h3><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-240-16a2bfba8.webp 240w, https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-300-16a2bfba8.webp 300w, https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-313-16a2bfba8.webp 313w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-240-16a2bfba8.png 240w, https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-300-16a2bfba8.png 300w, https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-313-16a2bfba8.png 313w" type="image/png" /><img class="pictinpost lazyload" width="313" height="161" src="https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-240-16a2bfba8.png" alt="valeur à retrouver" /></picture><h3 id="relève-le-nom-de-lentité">relève le nom de l’entité</h3><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-240-dfd53613e.webp 240w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-300-dfd53613e.webp 300w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-400-dfd53613e.webp 400w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-480-dfd53613e.webp 480w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-588-dfd53613e.webp 588w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-240-dfd53613e.png 240w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-300-dfd53613e.png 300w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-400-dfd53613e.png 400w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-480-dfd53613e.png 480w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-588-dfd53613e.png 588w" type="image/png" /><img class="pictinpost lazyload" width="588" height="873" src="https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-240-dfd53613e.png" alt="relevé le nom de l'entité" /></picture><h2 id="explications-du-code">Explications du code</h2><p>Le module de téléinfo que j’utilises ainsi que mon abonnement font remonter l’information heure-creuse/heure-pleine, pour raison personnelle je paie exactement la même chose quelque soit le tarif.</p><p><strong>On enregistre le premier état sous hc</strong></p><p><code>{% set hc = states('sensor.teleinfo_hchc') | float %}</code></p><p><strong>On enregistre le second état sous hp</strong></p><p><code>{% set hp = states('sensor.teleinfo_hchp') | float %}</code></p><p><strong>On affiche la valeur hc + hp le tout divisé par 2 et ensuite divisé par 1000 avec un arrondis de 2 après la virgule</strong></p><p><code>{{ ((hc + hp) / 2 / 1000) | round(2, default=0) }}</code></p><h3 id="résultat-du-code">Résultat du code</h3><figure class="highlight"><pre><code class="language-liquid" data-lang="liquid">{% set hc = states(&#39;sensor.teleinfo_hchc&#39;) | float %}
{% set hp = states(&#39;sensor.teleinfo_hchp&#39;) | float %}
{{ ((hc + hp) / 2 / 1000) | round(2, default=0) }}</code></pre></figure><h3 id="explication-animée">Explication animée</h3><blockquote><p>La classe de l’appareil et la classe d’état s’afficheront en rouge s’il y a une discordance avec l’entité choisi, c’est plutôt bien fait.</p></blockquote><p><img src="/assets/images/posts/119/creation-template-moyenne-sur-entite.webp" alt="Création d'un template sur les moyennes des entité dans home-assistant en gif animé" width="940" height="534" class="lazyload pictaninpost" /></p><blockquote><p>Tu pourras vérifier en direct les données remontées avant la validation du template.</p></blockquote></div></div><div class="sourcelink"> <span class="titlesource">Articles source</span><ol><li class="contentlink"> <a rel="canonical" href="https://www.home-assistant.io/integrations/template/" target="_blank">www.home-assistant.io</a><i class="icos external-link-alt-solid"></i><li class="contentlink"> <a rel="canonical" href="https://www.home-assistant.io/docs/configuration/templating/" target="_blank">www.home-assistant.io</a><i class="icos external-link-alt-solid"></i></ol></div><div class="authorbox mb-5 mt-5 pt-4 pb-4" itemscope itemtype="https://schema.org/Person"><div class="row"><div class="wrapavname col-md-3 text-center"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-110-5d88b8595.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-110-c8508425c.png 1.0x" type="image/png"> <img class="author-thumb" itemprop="image" width="110" height="110" src="https://haade.fr/assets/images/generated/nico-110-c8508425c.png" alt="Nico"> </picture><p class="mt-4 mb-0 small text-center"> <a target="_blank" class="d-inline-block mx-1 text-dark" itemprop="url" href="/fr/auteur-nico/"><i class="ico link-solid"></i></a> <a target="_blank" class="d-inline-block mx-1 text-dark" itemprop="sameAs" href="https://www.youtube.com/channel/UCcXJ1ZsjEvQxuWJy7gH-A6w"><i class="icob youtube"></i></a> <a target="_blank" class="d-inline-block mx-1 text-dark" itemprop="sameAs" href="https://github.com/haade-administrator"><i class="icob github"></i></a> <a target="_blank" class="d-inline-block mx-1 text-dark" itemprop="sameAs" href="https://discordapp.com/widget?id=637642871738073091&theme=dark&username=Nicoxygen#5644"><i class="icob discord"></i></a> <a class="d-inline-block mx-1 text-dark" itemprop="email" href="mailto:nico@haade.fr"><i class="ico envelope-solid"></i></a></p></div><div class="col-md-9"><h4 itemprop="name">Nico</h4><p class="mt-3 mb-0" itemprop="description">Membre fondateur du site Haade, voilà plus de 10 ans que je suis passionné de domotique, informatique et électronique. J'essaie à travers ce blog d'aider d'autres internautes à s'expérimenter en domotique, à trouver des tutos ludiques, bref à évoluer.</p></div></div></div><div class="comments mt-5"> <button class="btn btn-outline-dark py-2 px-5 d-block w-100 show-comments"><i class="ico comments-solid text-muted"></i> &nbsp; Afficher les Commentaires</button><div id="comments"><h4 class="mb-4">commentaires</h4><script src="https://giscus.app/client.js" data-repo=haade-administrator/haade.fr data-repo-id=R_kgDOHxeeuA data-category=Comments data-category-id=DIC_kwDOHxeeuM4CTn1C data-mapping=title data-strict=1 data-reactions-enabled=1 data-emit-metadata=0 data-theme=light data-input-position=top data-loading=lazy data-lang=fr crossorigin=anonymous async> </script><div class="clearfix"></div></div></div><div class=" related-posts"><h2 class="text-center mb-4">Articles qui pourrait t'intéresser</h2><div class="d-flex justify-content-center align-items-center"> <a class="smoothscroll badge badge-primary text-capitalize" href="/fr/categorie/haade-lab">Haade-lab</a> <a class="smoothscroll badge badge-primary text-capitalize" href="/fr/categorie/mini-tutos">Mini-tutos</a></div><div class="blog-grid-container"><div class="blog-grid-item"><div class="card h-100"><div class="maxthumb"> <a href="/fr/blog/test-ecran-tactile-murale-10-pouces-elc-smt101-et-integration-mqtt"><picture> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/164/test-et-integration-tablette-murale-elc-smt101-bandeau-led-mqtt-home-assistant-ultimate-dashboard-300-91db307f4.webp 300w, https://haade.fr/assets/images/generated/posts/164/test-et-integration-tablette-murale-elc-smt101-bandeau-led-mqtt-home-assistant-ultimate-dashboard-400-91db307f4.webp 400w, https://haade.fr/assets/images/generated/posts/164/test-et-integration-tablette-murale-elc-smt101-bandeau-led-mqtt-home-assistant-ultimate-dashboard-500-91db307f4.webp 500w, https://haade.fr/assets/images/generated/posts/164/test-et-integration-tablette-murale-elc-smt101-bandeau-led-mqtt-home-assistant-ultimate-dashboard-600-91db307f4.webp 600w, https://haade.fr/assets/images/generated/posts/164/test-et-integration-tablette-murale-elc-smt101-bandeau-led-mqtt-home-assistant-ultimate-dashboard-700-91db307f4.webp 700w, https://haade.fr/assets/images/generated/posts/164/test-et-integration-tablette-murale-elc-smt101-bandeau-led-mqtt-home-assistant-ultimate-dashboard-800-91db307f4.webp 800w" type="image/webp"> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/164/test-et-integration-tablette-murale-elc-smt101-bandeau-led-mqtt-home-assistant-ultimate-dashboard-300-91db307f4.png 300w, https://haade.fr/assets/images/generated/posts/164/test-et-integration-tablette-murale-elc-smt101-bandeau-led-mqtt-home-assistant-ultimate-dashboard-400-91db307f4.png 400w, https://haade.fr/assets/images/generated/posts/164/test-et-integration-tablette-murale-elc-smt101-bandeau-led-mqtt-home-assistant-ultimate-dashboard-500-91db307f4.png 500w, https://haade.fr/assets/images/generated/posts/164/test-et-integration-tablette-murale-elc-smt101-bandeau-led-mqtt-home-assistant-ultimate-dashboard-600-91db307f4.png 600w, https://haade.fr/assets/images/generated/posts/164/test-et-integration-tablette-murale-elc-smt101-bandeau-led-mqtt-home-assistant-ultimate-dashboard-700-91db307f4.png 700w, https://haade.fr/assets/images/generated/posts/164/test-et-integration-tablette-murale-elc-smt101-bandeau-led-mqtt-home-assistant-ultimate-dashboard-800-91db307f4.png 800w" type="image/png"> <img class="img-thumb lazyload" src="https://haade.fr/assets/images/generated/posts/164/test-et-integration-tablette-murale-elc-smt101-bandeau-led-mqtt-home-assistant-ultimate-dashboard-800-91db307f4.png" alt="Test de la tablette murale Android ELC-SMT101" width="1200" height="675"> </picture> </a></div><div class="card-body"><h2 class="card-title"> <a class="text-dark" href="/fr/blog/test-ecran-tactile-murale-10-pouces-elc-smt101-et-integration-mqtt">Test de la tablette murale Android ELC-SMT101</a><div class="mb-2 mt-2 font-weight-normal"><div class="rating-holder"><div class="Stars" style="--rating: 4.2; --star-background: #FF6600" title="Le produit est noté 4.2 sur 5."></div></div></div></h2><p class="card-text">Article coup de poing, aujourd’hui je vais tester la tablette 10,1 pouces de la marque ELC, la SMT101 aussi disponible en 9,7” et 15,6”, cette tablette a l’avantage d’être encastrable,...</p></div><div class="card-footer bg-white"><div class="wrapfooter"> <span class="meta-footer-thumb"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-40-5d88b8595.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-40-c8508425c.png 1.0x" type="image/png"> <img class="author-thumb" itemprop="image" width="40" height="40" src="https://haade.fr/assets/images/generated/nico-40-c8508425c.png" alt="Nico"> </picture> </span> <span class="author-meta"> <a href="/fr/auteur-nico"><span class="post-name font-weight-bold">Nico</span></a> <span class="post-date">25 juillet 2025</span> </span><div class="clearfix"></div></div></div></div></div><div class="blog-grid-item"><div class="card h-100"><div class="maxthumb"> <a href="/fr/blog/test-du-programmateur-arrosage-zigbee-sonoff-swv"><picture> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/163/test-programmateur-arrosage-sonoff-zigbee-swv-bsp-300-7cd2ffb90.webp 300w, https://haade.fr/assets/images/generated/posts/163/test-programmateur-arrosage-sonoff-zigbee-swv-bsp-400-7cd2ffb90.webp 400w, https://haade.fr/assets/images/generated/posts/163/test-programmateur-arrosage-sonoff-zigbee-swv-bsp-500-7cd2ffb90.webp 500w, https://haade.fr/assets/images/generated/posts/163/test-programmateur-arrosage-sonoff-zigbee-swv-bsp-600-7cd2ffb90.webp 600w, https://haade.fr/assets/images/generated/posts/163/test-programmateur-arrosage-sonoff-zigbee-swv-bsp-700-7cd2ffb90.webp 700w, https://haade.fr/assets/images/generated/posts/163/test-programmateur-arrosage-sonoff-zigbee-swv-bsp-800-7cd2ffb90.webp 800w" type="image/webp"> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/163/test-programmateur-arrosage-sonoff-zigbee-swv-bsp-300-7cd2ffb90.png 300w, https://haade.fr/assets/images/generated/posts/163/test-programmateur-arrosage-sonoff-zigbee-swv-bsp-400-7cd2ffb90.png 400w, https://haade.fr/assets/images/generated/posts/163/test-programmateur-arrosage-sonoff-zigbee-swv-bsp-500-7cd2ffb90.png 500w, https://haade.fr/assets/images/generated/posts/163/test-programmateur-arrosage-sonoff-zigbee-swv-bsp-600-7cd2ffb90.png 600w, https://haade.fr/assets/images/generated/posts/163/test-programmateur-arrosage-sonoff-zigbee-swv-bsp-700-7cd2ffb90.png 700w, https://haade.fr/assets/images/generated/posts/163/test-programmateur-arrosage-sonoff-zigbee-swv-bsp-800-7cd2ffb90.png 800w" type="image/png"> <img class="img-thumb lazyload" src="https://haade.fr/assets/images/generated/posts/163/test-programmateur-arrosage-sonoff-zigbee-swv-bsp-800-7cd2ffb90.png" alt="Test du programmateur Sonoff SWV-BSP" width="1200" height="675"> </picture> </a></div><div class="card-body"><h2 class="card-title"> <a class="text-dark" href="/fr/blog/test-du-programmateur-arrosage-zigbee-sonoff-swv">Test du programmateur Sonoff SWV-BSP</a><div class="mb-2 mt-2 font-weight-normal"><div class="rating-holder"><div class="Stars" style="--rating: 4.8; --star-background: #FF6600" title="Le produit est noté 4.8 sur 5."></div></div></div></h2><p class="card-text">Voilà un petit moment que je n’ai pas écris d’article, je m’en excuse, faute de temps et préparation d’un article coup de poing sur l’intégration d’une tablette murale en perspective....</p></div><div class="card-footer bg-white"><div class="wrapfooter"> <span class="meta-footer-thumb"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-40-5d88b8595.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-40-c8508425c.png 1.0x" type="image/png"> <img class="author-thumb" itemprop="image" width="40" height="40" src="https://haade.fr/assets/images/generated/nico-40-c8508425c.png" alt="Nico"> </picture> </span> <span class="author-meta"> <a href="/fr/auteur-nico"><span class="post-name font-weight-bold">Nico</span></a> <span class="post-date">25 juin 2025</span> </span><div class="clearfix"></div></div></div></div></div><div class="blog-grid-item"><div class="card h-100"><div class="maxthumb"> <a href="/fr/blog/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir"><picture> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-300-ff2b80a3e.webp 300w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-400-ff2b80a3e.webp 400w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-500-ff2b80a3e.webp 500w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-600-ff2b80a3e.webp 600w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-700-ff2b80a3e.webp 700w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-800-ff2b80a3e.webp 800w" type="image/webp"> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-300-ff2b80a3e.png 300w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-400-ff2b80a3e.png 400w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-500-ff2b80a3e.png 500w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-600-ff2b80a3e.png 600w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-700-ff2b80a3e.png 700w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-800-ff2b80a3e.png 800w" type="image/png"> <img class="img-thumb lazyload" src="https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-800-ff2b80a3e.png" alt="Comparatif Cam Slim VS Gen 2 Sonoff" width="1200" height="675"> </picture> </a></div><div class="card-body"><h2 class="card-title"> <a class="text-dark" href="/fr/blog/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir">Comparatif Cam Slim VS Gen 2 Sonoff</a><div class="mb-2 mt-2 font-weight-normal"><div class="rating-holder"><div class="Stars" style="--rating: 4.8; --star-background: #FF6600" title="Le produit est noté 4.8 sur 5."></div></div></div></h2><p class="card-text">Ajourd’hui comparons les deux caméras du moment Sonoff disponibles à moins de 30€ chez tous les commerçants auxquels nous sommes affiliés. Je remercie Domadoo et Itead de m’avoir fournis ce...</p></div><div class="card-footer bg-white"><div class="wrapfooter"> <span class="meta-footer-thumb"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-40-5d88b8595.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-40-c8508425c.png 1.0x" type="image/png"> <img class="author-thumb" itemprop="image" width="40" height="40" src="https://haade.fr/assets/images/generated/nico-40-c8508425c.png" alt="Nico"> </picture> </span> <span class="author-meta"> <a href="/fr/auteur-nico"><span class="post-name font-weight-bold">Nico</span></a> <span class="post-date">2 avril 2025</span> </span><div class="clearfix"></div></div></div></div></div></div></div></div></div><footer><div class="footcontent"><div class="footleft footbox"><div class="footupper"><div class="foottopic">À Propos</div><p>Haade est un blog destiné à aider les particuliers et professionnels à la mise en place d’un système domotique</p></div><div class="footlower"><div class="foottopic">Contactez-nous</div><div class="phone"> <a href="#"><i class="icos phone-volume-solid"></i>+0033 6 99 40 15 86</a></div><div class="email"> <a href="/fr/contact"><i class="icos envelope-solid"></i>Formulaire de contact</a></div></div></div><div class="footmiddle footbox"><div class="foottopic">Liens utiles</div><div><a href="/fr/rgpd-politique-de-confidentialite">Politique de confidentialité</a></div><div><a href="/fr/mentions-legales">Mentions legales</a></div><div><a target="_blank" href="https://buildwithmatter.com/">Protocole Matter</a></div><div><a target="_blank" href="https://zigbeealliance.org/fr/%C3%A9v%C3%A9nements/">Zigbee Alliance</a></div><div><a target="_blank" href="https://z-wavealliance.org/category/z-wave-in-the-news/">Z-wave Alliance</a></div><div><a target="_blank" href="https://www.aqara.com/eu/news.html">Aquara by Xiaomi</a></div><div><a target="_blank" href="https://itead.cc/">Itead Sonoff, Nextion</a></div></div><div class="footright footbox"><div class="foottopic">Inscrivez-vous à la Newsletter</div><form action="https://haade.us4.list-manage.com/subscribe/post?u=86f32891957737a57c0b4ade8&amp;id=92dadba2b4&amp;f_id=00639cebf0" method="post" name="embedded-mail" target="_blank"> <input type="email" placeholder="Entrez une adresse e-mail" name="EMAIL"> <input type="submit" name="Souscription" value="Envoyer" id="submit"> </form> <a href="https://github.com/haade-administrator/haade.fr/discussions" target="_blank" alt="github discussion link" aria-label="Continue la discussion sur le forum github"><i class="icob github" aria-hidden="true" title="github discussion"></i></a> <a target="_blank" href="https://www.youtube.com/channel/UCcXJ1ZsjEvQxuWJy7gH-A6w/?sub_confirmation=1" onclick="window.open(this.href, 'width=550,height=435');return false;" aria-label="Abonne toi à notre chaine youtube"><i class="icob youtube" aria-hidden="true" title="youtube"></i></a> <a target="_blank" href="https://discord.gg/FaK6MuZ2" onclick="window.open(this.href, 'width=550,height=435');return false;" aria-label="Invitation sur notre réseau Discord"><i class="icob discord" aria-hidden="true" title="discord"></i></a> <a href="/fr/feed.xml" target="_blank" alt="feed rss" aria-label="partage le flux rss avec tes amis"><i class="icob rss" aria-hidden="true" title="feed rss haade"></i></a></div></div></div><div class="footbottom"><p>Copyright © 2025 <a target="_blank" href="https://www.haade.fr">Haade</a> 🎉 by Nicoxygen</p></div></footer></div><script src="/assets/js/main.min.js?v=a0225e1608e525477f5b4a4ae3f3425c" type="text/javascript"></script> <script src="/assets/js/lunrsearchengine-fr.js?v=ceef0e36504019105ad7abc454ff314e"></script>
