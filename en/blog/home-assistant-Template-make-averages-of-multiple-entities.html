<!DOCTYPE html><html lang="en-GB"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="icon" href="/assets/images/logo.png"><title>Template - Create an average on entities - Haade.fr</title><meta name="description" content="mini tutorials on templates in home assistant, how to create an average of the state of several entities."><meta name="author" content="Nico"><link rel="canonical" href="https://haade.fr/en/blog/home-assistant-Template-make-averages-of-multiple-entities"><link rel="alternate" hreflang="en" href="https://haade.fr/en/blog/home-assistant-Template-make-averages-of-multiple-entities"/><link rel="alternate" hreflang="fr" href="https://haade.fr/fr/blog/home-assistant-Template-faire-des-moyennes-de-plusieurs-entites"/><meta property="og:locale" content="fr-FR"><meta property="og:type" content="article"><meta property="og:title" content="Template - Create an average on entities"><meta property="og:description" content="mini tutorials on templates in home assistant, how to create an average of the state of several entities."><meta property="og:url" content="https://haade.fr/en/blog/home-assistant-Template-make-averages-of-multiple-entities"><meta property="og:site_name" content="Haade.fr"><meta property="og:image" content="https://haade.fr/create-an-average-on-entities-template-home-assistant.png"><meta property="article:author" content="Nico"><meta property="article:published_time" content="2024-04-11T12:30:00+02:00"> <script type="application/ld+json"> { "@context": "https://schema.org", "@type": "BlogPosting", "url": "https://haade.fr/en/blog/home-assistant-Template-make-averages-of-multiple-entities", "name": "Template - Create an average on entities", "headline": "Template - Create an average on entities", "keywords": "Haade-lab,Mini-tutos", "description": "mini tutorials on templates in home assistant, how to create an average of the state of several entities.", "articleBody": "For our first template tutorial, I suggest you create averages from the state of the values of the entities (sensor). In my cases I need to take an average of two values concerning the off-peak/peak time teleinformation in order to bring up a single common value. In addition it is expressed by default in Wh and I would like to transform it into KWh. You will see that Liquid/Jinja` itâ€™s not very complicated!\n\nPrerequisites\n\nHome Assistant installed\n\n\n \n\n \n \n \n Box HomeAssistant Green\n By Nabu Casa\n Box Home Assistant Green on sale at domadoo for less than â‚¬100\n \n \n \n \n Buy Now out of Domadoo\n \n \n \n \n \n \n\n\nTemplate and entity\n\nTo create a template, nothing could be simpler, go to home assistant\n\n\n Parameters/inputs/create an entry/template/Model a sensor\n\n\nget the values\n\n\n\nnotes the name of the entity\n\n\n\nCode explanations\n\nThe teleinfo module that I use as well as my subscription provide off-peak/peak time information, for personal reasons I pay exactly the same thing whatever the price.\n\nWe save the first state under hc\n\n{% set hc = states('sensor.teleinfo_hchc') | float %}\n\nWe save the second state under hp\n\n{% set hp = states('sensor.teleinfo_hchp') | float %}\n\nWe display the hc + hp value all divided by 2 and then divided by 1000 with rounding of 2 after the decimal point\n\n{{ ((hc + hp) / 2 / 1000) | round(2, default=0) }}\n\nCode result\n\n{% set hc = states(&#39;sensor.teleinfo_hchc&#39;) | float %}\n{% set hp = states(&#39;sensor.teleinfo_hchp&#39;) | float %}\n{{ ((hc + hp) / 2 / 1000) | round(2, default=0) }}\n\nAnimated explanation\n\n\n The device class and the state class will be displayed in red if there is a mismatch with the chosen entity, itâ€™s pretty well done.\n\n\n\n\n\n You will be able to check the data provided directly before validating the template.\n\n", "datePublished": "2024-04-11 12:30:00 +0200", "dateModified": "2024-04-11 12:30:00 +0200", "inLanguage": "en-GB", "author": { "@type": "Person", "name": "Nico", "alternateName": "Nico", "description": "Founding member of the Haade site, a home automation enthusiast with all the tricks that go well.", "url": "/fr/auteur-nico/","image": "https://haade.fr/nico.jpg","email": "nico@haade.fr" }, "publisher": { "@type": "Organization", "name": "Haade.fr", "url": "https://haade.fr", "logo": { "@type": "ImageObject", "width": 250, "height": 63, "url": "https://haade.fr/assets/images/logo.png" } }, "mainEntityOfPage": { "@type": "WebPage", "@id": "https://haade.fr/en/blog/home-assistant-Template-make-averages-of-multiple-entities" }, "image": { "@type": "ImageObject", "width": 250, "height": 94, "url": "https://haade.fr/create-an-average-on-entities-template-home-assistant.png" } } </script><link href="/assets/css/theme.css?v=1715221916227248514" media="screen, projection, print" rel="stylesheet"> <script data-goatcounter="https://haade.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script><link rel="preload" href="/assets/fonts/montserrat/Montserrat-VariableFont_wght.woff2" as="font" crossorigin><link rel="preload" href="/assets/fonts/icomoon/icomoon.woff2?4fpajq" as="font" crossorigin><link rel="shortcut icon" type="image/x-icon" href="/assets/images/favicon.ico" ><link rel="shortcut icon" type="image/png" href="/assets/images/favicon.png" ><header><div class="firstnavbar"><div class="links"> <a href="/en/">Home</a> <a href="/en/gdpr-general-data-protection-regulation/">GDPR</a> <a href="/en/contact/">Contact</a><div class="sl-nav"> language:<ul><li><b>English</b> <i class="ico angle-down-solid triangle-arrow trrow" aria-hidden="true"></i><div class="triangle"></div><ul class="show-flags"><li><a href="/fr/blog/home-assistant-Template-faire-des-moyennes-de-plusieurs-entites"><i class="sl-flag fix flag-fr"><div id="Francais"></div></i><span class="active">Francais</span></a><li class="current"><a href="/en/blog/home-assistant-Template-make-averages-of-multiple-entities"><i class="sl-flag fix flag-england"><div id="English"></div></i><span class="active">English</span></a></ul></ul></div></div><div class="social-firstnav"> <a href="https://github.com/haade-administrator/haade.fr/discussions" target="_blank" alt="github discussion link" aria-label="Continue the discussion on the github forum"><i class="icob github" width="1em" height="1em" aria-hidden="true" title="github discussion"></i></a> <a href="https://www.youtube.com/channel/UCcXJ1ZsjEvQxuWJy7gH-A6w/?sub_confirmation=1" onclick="window.open(this.href, 'width=550,height=435');return false;" aria-label="Subscribe to our youtube channel"><i class="icob youtube" width="1em" height="1em" target="_blank" alt="youtube" aria-hidden="true" title="youtube"></i></a> <a href="https://discord.gg/FaK6MuZ2" onclick="window.open(this.href, 'width=550,height=435');return false;" aria-label="Invitation to our Discord network"><i class="icob discord" width="1em" height="1em" target="_blank" alt="discord" aria-hidden="true" title="discord"></i></a> <a href="/en/feed.xml" target="_blank" alt="feed rss" aria-label="share the rss feed with your friends"><i class="icob rss" width="1em" height="1em" aria-hidden="true" title="feed rss haade"></i></a></div></div><div class="secondheader"> <a class="navbar-brand" href="/en/"><picture> <source sizes="(max-width: 524px) 150px, 250px" srcset="https://haade.fr/assets/images/generated/logo-150-379587352.webp 150w, https://haade.fr/assets/images/generated/logo-250-379587352.webp 250w" type="image/webp"> <source sizes="(max-width: 524px) 150px, 250px" srcset="https://haade.fr/assets/images/generated/logo-150-64f85a78e.png 150w, https://haade.fr/assets/images/generated/logo-250-64f85a78e.png 250w" type="image/png"> <img id="logoIImage" src="https://haade.fr/assets/images/generated/logo-250-64f85a78e.png" alt="Logo officiel du site domotique Haade" width="250" height="94"> </picture> </a><p class="sitetag"> Home Assistance Alsace home automation & electronics.</p></div><nav id="nav"><div class="navbar"> <i class='icos bars-solid'></i><div class="nav-links"><div class="sidebar-logo"> <span class="logo-name">H2Ade</span> <i class='icos times-solid'></i></div><ul class="links"><li><a href="/en/">Home<span class="badge badge-light tags">112</span></a><li> <a href="https://haade.fr/en/category/automation">Automation</a> <i class="icos angle-down-solid htmlcss-arrow-automation arrow"></i><ul class="htmlCss-sub-menu-automation sub-menu"><li><a href="/en/category/security">Security</a><li class="more"> <span><a href="/en/category/haade-lab">Tutos</a> <i class='icos angle-right-solid arrow more-arrow-automation'></i> </span><ul class="more-sub-menu-automation sub-menu"><li><a href="/en/category/mini-tutorials">Mini-tutorials</a><li><a href="/en/category/videos">Videos</a><li><a href="/en/category/home-assistant">Home-Assistant</a><li><a href="/en/category/jeedom">Jeedom</a></ul></ul><li><a href="/en/category/news">News</a><li><a href="/en/category/tests">Tests</a><li><a href="/en/authors">Contributors<span class="badge badge-primary">News</span></a><li><a target="_blank" href="https://github.com/haade-administrator/haade.fr/discussions">Forum</a><li><a href="/en/category-product/shop">Shop</a> <i class="icos angle-down-solid htmlcss-arrow-shop arrow"></i><ul class="htmlCss-sub-menu-shop sub-menu"><li class="more"> <span><a href="#">Brand</a> <i class='icos angle-right-solid arrow more-arrow-brand'></i> </span><ul class="more-sub-menu-brand sub-menu"><li><a href="/en/category-product/jeedom">Jeedom</a><li><a href="/en/category-product/moes">Moes</a><li><a href="/en/category-product/neo-coolcam">Neo-Coolcam</a><li><a href="/en/category-product/nodon">Nodon</a><li><a href="/en/category-product/raspberry-pi">Raspberry-pi</a><li><a href="/en/category-product/sonoff">Sonoff</a><li><a href="/en/category-product/tedee">Tedee</a><li><a href="/en/category-product/xiaomi">Xiaomi</a><li><a href="/en/category-product/zemismart">Zemismart</a></ul><li class="more"> <span><a href="#">Protocol</a> <i class='ico angle-right-solid arrow more-arrow-protocol'></i> </span><ul class="more-sub-menu-protocol sub-menu"><li><a href="/en/category-product/bluetooth">Bluetooth</a><li><a href="/en/category-product/esp">Esp 32/8266</a><li><a href="/en/category-product/matter">Matter</a><li><a href="/en/category-product/wifi">Wifi</a><li><a href="/en/category-product/zigbee">Zigbee</a><li><a href="/en/category-product/zwave">Z-wave</a></ul></ul><li><div class="sl-nav"> language:<ul><li><b>English</b> <i class="ico angle-down-solid triangle-arrow trrow" aria-hidden="true"></i><div class="triangle"></div><ul class="show-flags"><li><a href="/fr/blog/home-assistant-Template-faire-des-moyennes-de-plusieurs-entites"><i class="sl-flag fix flag-fr"><div id="Francais"></div></i><span class="active">Francais</span></a><li class="current"><a href="/en/blog/home-assistant-Template-make-averages-of-multiple-entities"><i class="sl-flag fix flag-england"><div id="English"></div></i><span class="active">English</span></a></ul></ul></div></ul></div><script src="/assets/js/lunr.min.js?v=a944ea77ca394dff9a667d5aea56f0e9" type="text/javascript"></script><div class="search-box"> <i class='icos search-solid'></i><div class="input-box"> <form onSubmit="return lunr_search(document.getElementById('lunrsearch').value);" class="search-form" role="search"> <input autocomplete="on" id="lunrsearch" class="search-input" name="q" maxlength="200" placeholder="Search..." type="search" value=""> <input class="search-action" type="submit" value="Ok"> </form></div><div id="lunrsearchresults"><ul></ul></div></div></div></nav></header><div class="site-content"><div class="container"><div class="main-content"> <script> var addViews = ""; var addViewsValue = parseInt(addViews); var r = new XMLHttpRequest(); r.addEventListener('load', function() { var visits = parseInt(JSON.parse(this.responseText).count.replace(/\s/g, '')); var totalVisits = visits; if (!isNaN(addViewsValue)) { totalVisits += addViewsValue; } document.getElementById('visits').innerText = totalVisits; }); r.open('GET', 'https://haade.goatcounter.com/counter/' + encodeURIComponent(location.pathname) + '.json'); r.send(); </script><div class="entry-header"><nav class="ariane"><ol class="arianefil" itemscope itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"> <a itemprop="item" href="https://haade.fr/en/"><span itemprop="name">Home</span></a><meta itemprop="position" content="1"><li><span class="prompt">&nbsp; > &nbsp;</span><li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" href="https://haade.fr/en/category/haade-lab"><span itemprop="name">Haade-lab</span></a><meta itemprop="position" content="2"><li><span class="prompt">&nbsp; > &nbsp;</span>Template - Create an average on entities</ol></nav><h1 class="posttitle">Template - Create an average on entities</h1><div class="d-flex align-items-start mt-4"><div class="authorpost"> <a href="/en/author-nico"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-60-477f2654d.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-60-78aa7390f.jpg 1.0x" type="image/jpeg"> <img class="author-thumb" itemprop="image" width="60" height="60" src="https://haade.fr/assets/images/generated/nico-60-78aa7390f.jpg" alt="Nico"> </picture> </a> Writing by <a href="/en/author-nico"><b>Nico</b></a></div><div class="readingpost">&nbsp;<i class="icos calendar-check" width="1em" height="1em"></i> <span class="post-date"><time class="post-date" datetime="11-04-2024">11<sup>th</sup>April 2024 &nbsp; </time></span> <span><span class="reading-time" title="Estimated read time"> <i class="icos history" width="1em" height="1em"></i> <strong> 2 min</strong> of reading </span> </span><p><i class="icos eye-solid" width="1em" height="1em"></i> This page has been visited <span id="visits" style="font-weight:bold">...</span> times</p></div></div></div><div class="entry-featured-image"><picture> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) 800px, (min-width: 1025px) 940px, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-300-7e36b146b.webp 300w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-400-7e36b146b.webp 400w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-500-7e36b146b.webp 500w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-600-7e36b146b.webp 600w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-700-7e36b146b.webp 700w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-800-7e36b146b.webp 800w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-900-7e36b146b.webp 900w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-940-7e36b146b.webp 940w" type="image/webp"> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) 800px, (min-width: 1025px) 940px, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-300-7e36b146b.png 300w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-400-7e36b146b.png 400w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-500-7e36b146b.png 500w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-600-7e36b146b.png 600w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-700-7e36b146b.png 700w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-800-7e36b146b.png 800w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-900-7e36b146b.png 900w, https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-940-7e36b146b.png 940w" type="image/png"> <img class="lazyload featured-image-post" width="940" height="529" itemprop="image" src="https://haade.fr/assets/images/generated/posts/119/create-an-average-on-entities-template-home-assistant-940-7e36b146b.png" alt="Template - Create an average on entities"> </picture></div><div class="article-post"><p><em></em></p><div class="toc mt-4 mb-4 lead"><h3 class="font-weight-bold">Sommary</h3><ul class="table_of"><li class="toc"><a href="#prerequisites" class="toc_anchor">Prerequisites</a><li class="toc"><a href="#template-and-entity" class="toc_anchor">Template and entity</a><ul class="toc_sub"><li class="toc"><a href="#get-the-values" class="toc_anchor">get the values</a><li class="toc"><a href="#notes-the-name-of-the-entity" class="toc_anchor">notes the name of the entity</a></ul><li class="toc"><a href="#code-explanations" class="toc_anchor">Code explanations</a><ul class="toc_sub"><li class="toc"><a href="#code-result" class="toc_anchor">Code result</a><li class="toc"><a href="#animated-explanation" class="toc_anchor">Animated explanation</a></ul></ul></div><div class="content-post"><p>For our first template tutorial, I suggest you <strong>create averages from the state of the values of the entities</strong> (sensor). In my cases I need to take an average of two values concerning the off-peak/peak time teleinformation in order to bring up a single common value. In addition it is expressed by default in Wh and I would like to transform it into KWh. You will see that <code>Liquid/Jinja</code>` <strong>itâ€™s not very complicated!</strong></p><h2 id="prerequisites">Prerequisites</h2><p><strong>Home Assistant installed</strong></p><div class="embedproduct"><div class="embedproduct-picture"><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/119/Home-Assistant-Green-240-584f1743f.webp 240w, https://haade.fr/assets/images/generated/posts/119/Home-Assistant-Green-250-584f1743f.webp 250w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/119/Home-Assistant-Green-240-584f1743f.png 240w, https://haade.fr/assets/images/generated/posts/119/Home-Assistant-Green-250-584f1743f.png 250w" type="image/png" /><img class="pictinpost lazyload" width="250" height="250" src="https://haade.fr/assets/images/generated/posts/119/Home-Assistant-Green-240-584f1743f.png" alt="Box Home Assistant Green on sale at domadoo for less than â‚¬100" /></picture></div><div class="text"><div class="embedproduct-info"><h2 class="no_toc">Box HomeAssistant Green</h2><h3 class="no_toc">By Nabu Casa</h3><p>Box Home Assistant Green on sale at domadoo for less than â‚¬100</p></div><div class="embedproduct-price"><div class="embedaffiliate"> <span class="dombutton" role="button"><a href="https://www.domadoo.fr/en/smart-home-gateway/7046-nabu-casa-home-assistant-green-smart-home-hub-0794677011758.html?domid=39" target="_blank" rel="nofollow noopener"><img src="/assets/images/domadoo.png" width="20" height="20" class="lazyload" alt="domadoo logo" /> Buy Now out of Domadoo</a></span></div></div></div></div><h2 id="template-and-entity">Template and entity</h2><p>To create a template, nothing could be simpler, go to home assistant</p><blockquote><p><strong>Parameters/inputs/create an entry/template/Model a sensor</strong></p></blockquote><h3 id="get-the-values">get the values</h3><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-240-16a2bfba8.webp 240w, https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-300-16a2bfba8.webp 300w, https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-313-16a2bfba8.webp 313w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-240-16a2bfba8.png 240w, https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-300-16a2bfba8.png 300w, https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-313-16a2bfba8.png 313w" type="image/png" /><img class="pictinpost lazyload" width="313" height="161" src="https://haade.fr/assets/images/generated/posts/119/entites-releves-creation-moyenne-template-240-16a2bfba8.png" alt="value to be noted" /></picture><h3 id="notes-the-name-of-the-entity">notes the name of the entity</h3><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-240-dfd53613e.webp 240w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-300-dfd53613e.webp 300w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-400-dfd53613e.webp 400w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-480-dfd53613e.webp 480w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-588-dfd53613e.webp 588w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-240-dfd53613e.png 240w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-300-dfd53613e.png 300w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-400-dfd53613e.png 400w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-480-dfd53613e.png 480w, https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-588-dfd53613e.png 588w" type="image/png" /><img class="pictinpost lazyload" width="588" height="873" src="https://haade.fr/assets/images/generated/posts/119/releve-sensor-teleinfo-creation-template-home-assistant-240-dfd53613e.png" alt="find the name of the entities" /></picture><h2 id="code-explanations">Code explanations</h2><p>The teleinfo module that I use as well as my subscription provide off-peak/peak time information, for personal reasons I pay exactly the same thing whatever the price.</p><p><strong>We save the first state under hc</strong></p><p><code>{% set hc = states('sensor.teleinfo_hchc') | float %}</code></p><p><strong>We save the second state under hp</strong></p><p><code>{% set hp = states('sensor.teleinfo_hchp') | float %}</code></p><p><strong>We display the hc + hp value all divided by 2 and then divided by 1000 with rounding of 2 after the decimal point</strong></p><p><code>{{ ((hc + hp) / 2 / 1000) | round(2, default=0) }}</code></p><h3 id="code-result">Code result</h3><figure class="highlight"><pre><code class="language-liquid" data-lang="liquid">{% set hc = states(&#39;sensor.teleinfo_hchc&#39;) | float %}
{% set hp = states(&#39;sensor.teleinfo_hchp&#39;) | float %}
{{ ((hc + hp) / 2 / 1000) | round(2, default=0) }}</code></pre></figure><h3 id="animated-explanation">Animated explanation</h3><blockquote><p>The device class and the state class will be displayed in red if there is a mismatch with the chosen entity, itâ€™s pretty well done.</p></blockquote><p><img src="/assets/images/posts/119/creation-template-moyenne-sur-entite.webp" alt="Creation of a template on entity averages in home-assistant in animated gif" width="940" height="534" class="lazyload" /></p><blockquote><p>You will be able to check the data provided directly before validating the template.</p></blockquote></div></div><div class="sourcelink"> <span class="titlesource">Source posts</span><ol><li class="contentlink"> <a rel="canonical" href="https://www.home-assistant.io/integrations/template/" target="_blank">www.home-assistant.io</a><i class="icos external-link-alt-solid"></i><li class="contentlink"> <a rel="canonical" href="https://www.home-assistant.io/docs/configuration/templating/" target="_blank">www.home-assistant.io</a><i class="icos external-link-alt-solid"></i></ol></div><div class="authorbox mb-5 mt-5 pt-4 pb-4" itemscope itemtype="https://schema.org/Person"><div class="row"><div class="wrapavname col-md-3 text-center"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-110-477f2654d.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-110-78aa7390f.jpg 1.0x" type="image/jpeg"> <img class="author-thumb" itemprop="image" width="110" height="110" src="https://haade.fr/assets/images/generated/nico-110-78aa7390f.jpg" alt="Nico"> </picture><p class="mt-4 mb-0 small text-center"> <a target="_blank" class="d-inline-block mx-1 text-dark" itemprop="url" href="/fr/auteur-nico/"><i class="ico link-solid"></i></a> <a target="_blank" class="d-inline-block mx-1 text-dark" itemprop="sameAs" href="https://www.youtube.com/channel/UCcXJ1ZsjEvQxuWJy7gH-A6w"><i class="icob youtube"></i></a> <a target="_blank" class="d-inline-block mx-1 text-dark" itemprop="sameAs" href="https://github.com/haade-administrator"><i class="icob github"></i></a> <a target="_blank" class="d-inline-block mx-1 text-dark" itemprop="sameAs" href="https://discordapp.com/widget?id=637642871738073091&theme=dark&username=Nicoxygen#5644"><i class="icob discord"></i></a> <a class="d-inline-block mx-1 text-dark" itemprop="email" href="mailto:nico@haade.fr"><i class="ico envelope-solid"></i></a></p></div><div class="col-md-9"><h4 itemprop="name">Nico</h4><p class="mt-3 mb-0" itemprop="description">Founding member of the Haade site, a home automation enthusiast with all the tricks that go well.</p></div></div></div><div class="comments mt-5"> <button class="btn btn-outline-dark py-2 px-5 d-block w-100 show-comments"><i class="ico comments-solid text-muted"></i> &nbsp; Load the Comments</button><div id="comments"><h4 class="mb-4">Comments</h4><script src="https://giscus.app/client.js" data-repo=haade-administrator/haade.fr data-repo-id=R_kgDOHxeeuA data-category=Comments data-category-id=DIC_kwDOHxeeuM4CTn1C data-mapping=title data-strict=1 data-reactions-enabled=1 data-emit-metadata=0 data-theme=light data-input-position=top data-loading=lazy data-lang=en crossorigin=anonymous async> </script><div class="clearfix"></div></div></div><div class=" related-posts"><h2 class="text-center mb-4">Articles that might interest you</h2><div class="d-flex justify-content-center align-items-center"> <a class="smoothscroll badge badge-primary text-capitalize" href="/en/category/haade-lab">Haade-lab</a> <a class="smoothscroll badge badge-primary text-capitalize" href="/en/category/mini-tutos">Mini-tutos</a></div><div class="blog-grid-container"><div class="blog-grid-item"><div class="card h-100"><div class="maxthumb"> <a href="/en/blog/test-of-sonoff-zbmini-l2-pushes-to-the-extreme"><picture> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/124/test-micro-module-sonoff-zbmini-l2-pousse-a-l-extreme-300-ed9a96aea.webp 300w, https://haade.fr/assets/images/generated/posts/124/test-micro-module-sonoff-zbmini-l2-pousse-a-l-extreme-400-ed9a96aea.webp 400w, https://haade.fr/assets/images/generated/posts/124/test-micro-module-sonoff-zbmini-l2-pousse-a-l-extreme-500-ed9a96aea.webp 500w, https://haade.fr/assets/images/generated/posts/124/test-micro-module-sonoff-zbmini-l2-pousse-a-l-extreme-600-ed9a96aea.webp 600w, https://haade.fr/assets/images/generated/posts/124/test-micro-module-sonoff-zbmini-l2-pousse-a-l-extreme-700-ed9a96aea.webp 700w, https://haade.fr/assets/images/generated/posts/124/test-micro-module-sonoff-zbmini-l2-pousse-a-l-extreme-800-ed9a96aea.webp 800w" type="image/webp"> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/124/test-micro-module-sonoff-zbmini-l2-pousse-a-l-extreme-300-ed9a96aea.png 300w, https://haade.fr/assets/images/generated/posts/124/test-micro-module-sonoff-zbmini-l2-pousse-a-l-extreme-400-ed9a96aea.png 400w, https://haade.fr/assets/images/generated/posts/124/test-micro-module-sonoff-zbmini-l2-pousse-a-l-extreme-500-ed9a96aea.png 500w, https://haade.fr/assets/images/generated/posts/124/test-micro-module-sonoff-zbmini-l2-pousse-a-l-extreme-600-ed9a96aea.png 600w, https://haade.fr/assets/images/generated/posts/124/test-micro-module-sonoff-zbmini-l2-pousse-a-l-extreme-700-ed9a96aea.png 700w, https://haade.fr/assets/images/generated/posts/124/test-micro-module-sonoff-zbmini-l2-pousse-a-l-extreme-800-ed9a96aea.png 800w" type="image/png"> <img class="img-thumb lazyload" src="https://haade.fr/assets/images/generated/posts/124/test-micro-module-sonoff-zbmini-l2-pousse-a-l-extreme-800-ed9a96aea.png" alt="Sonoff zbmini-l2 test taken to the extreme" width="1200" height="675"> </picture> </a></div><div class="card-body"><h2 class="card-title"> <a class="text-dark" href="/en/blog/test-of-sonoff-zbmini-l2-pushes-to-the-extreme">Sonoff zbmini-l2 test taken to the extreme</a></h2><p class="card-text">Hereâ€™s a video where you might have a laugh, with the band August and Lulu we all 3 decided to test the Sonoff Zbmini-L2 in a most extreme way by...</p></div><div class="card-footer bg-white"><div class="wrapfooter"> <span class="meta-footer-thumb"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-40-477f2654d.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-40-78aa7390f.jpg 1.0x" type="image/jpeg"> <img class="author-thumb" itemprop="image" width="40" height="40" src="https://haade.fr/assets/images/generated/nico-40-78aa7390f.jpg" alt="Nico"> </picture> </span> <span class="author-meta"> <a href="/en/author-nico"><span class="post-name font-weight-bold">Nico</span></a> <span class="meta-footer-thumb"><picture> <source srcset="https://haade.fr/assets/images/generated/august-40-be997cfb5.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/august-40-280b2576b.png 1.0x" type="image/png"> <img class="author-thumb" itemprop="image" width="40" height="40" src="https://haade.fr/assets/images/generated/august-40-280b2576b.png" alt="August"> </picture> </span> <span class="author-meta"> <a href="/en/author-august"><span class="post-name font-weight-bold">August</span></a> <span class="post-date"> 3<sup>rd</sup>May 2024</span> </span><div class="clearfix"></div></div></div></div></div><div class="blog-grid-item"><div class="card h-100"><div class="maxthumb"> <a href="/en/blog/change-the-result-of-one-entity-state-attribute-command-to-another-in-home-assistant-with-templates"><picture> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/122/home-assistant-mini-tutos-haade-lab-create-an-average-on-entities-with-template-300-0bebd13d0.webp 300w, https://haade.fr/assets/images/generated/posts/122/home-assistant-mini-tutos-haade-lab-create-an-average-on-entities-with-template-400-0bebd13d0.webp 400w, https://haade.fr/assets/images/generated/posts/122/home-assistant-mini-tutos-haade-lab-create-an-average-on-entities-with-template-500-0bebd13d0.webp 500w, https://haade.fr/assets/images/generated/posts/122/home-assistant-mini-tutos-haade-lab-create-an-average-on-entities-with-template-600-0bebd13d0.webp 600w, https://haade.fr/assets/images/generated/posts/122/home-assistant-mini-tutos-haade-lab-create-an-average-on-entities-with-template-700-0bebd13d0.webp 700w, https://haade.fr/assets/images/generated/posts/122/home-assistant-mini-tutos-haade-lab-create-an-average-on-entities-with-template-800-0bebd13d0.webp 800w" type="image/webp"> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/122/home-assistant-mini-tutos-haade-lab-create-an-average-on-entities-with-template-300-0bebd13d0.png 300w, https://haade.fr/assets/images/generated/posts/122/home-assistant-mini-tutos-haade-lab-create-an-average-on-entities-with-template-400-0bebd13d0.png 400w, https://haade.fr/assets/images/generated/posts/122/home-assistant-mini-tutos-haade-lab-create-an-average-on-entities-with-template-500-0bebd13d0.png 500w, https://haade.fr/assets/images/generated/posts/122/home-assistant-mini-tutos-haade-lab-create-an-average-on-entities-with-template-600-0bebd13d0.png 600w, https://haade.fr/assets/images/generated/posts/122/home-assistant-mini-tutos-haade-lab-create-an-average-on-entities-with-template-700-0bebd13d0.png 700w, https://haade.fr/assets/images/generated/posts/122/home-assistant-mini-tutos-haade-lab-create-an-average-on-entities-with-template-800-0bebd13d0.png 800w" type="image/png"> <img class="img-thumb lazyload" src="https://haade.fr/assets/images/generated/posts/122/home-assistant-mini-tutos-haade-lab-create-an-average-on-entities-with-template-800-0bebd13d0.png" alt="Change the result of an entity's state attribute" width="1200" height="675"> </picture> </a></div><div class="card-body"><h2 class="card-title"> <a class="text-dark" href="/en/blog/change-the-result-of-one-entity-state-attribute-command-to-another-in-home-assistant-with-templates">Change the result of an entity's state attribute</a></h2><p class="card-text">In the previous article I showed you how to create an average of states on entities, by making a call on an entity state states() which directly reports the state...</p></div><div class="card-footer bg-white"><div class="wrapfooter"> <span class="meta-footer-thumb"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-40-477f2654d.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-40-78aa7390f.jpg 1.0x" type="image/jpeg"> <img class="author-thumb" itemprop="image" width="40" height="40" src="https://haade.fr/assets/images/generated/nico-40-78aa7390f.jpg" alt="Nico"> </picture> </span> <span class="author-meta"> <a href="/en/author-nico"><span class="post-name font-weight-bold">Nico</span></a> <span class="post-date">29<sup>th</sup>April 2024</span> </span><div class="clearfix"></div></div></div></div></div><div class="blog-grid-item"><div class="card h-100"><div class="maxthumb"> <a href="/en/blog/comparatif-youtube-thermostatic-valve-moes-sonoff-aqara"><picture> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/121/youtube-haade-labs-comparatif-robinet-thermostatique-moes-sonoff-aqara-300-c2f94f9ef.webp 300w, https://haade.fr/assets/images/generated/posts/121/youtube-haade-labs-comparatif-robinet-thermostatique-moes-sonoff-aqara-400-c2f94f9ef.webp 400w, https://haade.fr/assets/images/generated/posts/121/youtube-haade-labs-comparatif-robinet-thermostatique-moes-sonoff-aqara-500-c2f94f9ef.webp 500w, https://haade.fr/assets/images/generated/posts/121/youtube-haade-labs-comparatif-robinet-thermostatique-moes-sonoff-aqara-600-c2f94f9ef.webp 600w, https://haade.fr/assets/images/generated/posts/121/youtube-haade-labs-comparatif-robinet-thermostatique-moes-sonoff-aqara-700-c2f94f9ef.webp 700w, https://haade.fr/assets/images/generated/posts/121/youtube-haade-labs-comparatif-robinet-thermostatique-moes-sonoff-aqara-800-c2f94f9ef.webp 800w" type="image/webp"> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/121/youtube-haade-labs-comparatif-robinet-thermostatique-moes-sonoff-aqara-300-c2f94f9ef.png 300w, https://haade.fr/assets/images/generated/posts/121/youtube-haade-labs-comparatif-robinet-thermostatique-moes-sonoff-aqara-400-c2f94f9ef.png 400w, https://haade.fr/assets/images/generated/posts/121/youtube-haade-labs-comparatif-robinet-thermostatique-moes-sonoff-aqara-500-c2f94f9ef.png 500w, https://haade.fr/assets/images/generated/posts/121/youtube-haade-labs-comparatif-robinet-thermostatique-moes-sonoff-aqara-600-c2f94f9ef.png 600w, https://haade.fr/assets/images/generated/posts/121/youtube-haade-labs-comparatif-robinet-thermostatique-moes-sonoff-aqara-700-c2f94f9ef.png 700w, https://haade.fr/assets/images/generated/posts/121/youtube-haade-labs-comparatif-robinet-thermostatique-moes-sonoff-aqara-800-c2f94f9ef.png 800w" type="image/png"> <img class="img-thumb lazyload" src="https://haade.fr/assets/images/generated/posts/121/youtube-haade-labs-comparatif-robinet-thermostatique-moes-sonoff-aqara-800-c2f94f9ef.png" alt="Video comparison of Moes, Aqara and Sonoff thermostatic faucets" width="1200" height="675"> </picture> </a></div><div class="card-body"><h2 class="card-title"> <a class="text-dark" href="/en/blog/comparatif-youtube-thermostatic-valve-moes-sonoff-aqara">Video comparison of Moes, Aqara and Sonoff thermostatic faucets</a></h2><p class="card-text">Following the video saving heating thanks to home automation it works, August returns with a comparison of thermostatic faucets Moes ZTRV-BY-100, Aqara SRTS-A01 and Sonoff TRVZB, interestingly his vision as...</p></div><div class="card-footer bg-white"><div class="wrapfooter"> <span class="meta-footer-thumb"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-40-477f2654d.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-40-78aa7390f.jpg 1.0x" type="image/jpeg"> <img class="author-thumb" itemprop="image" width="40" height="40" src="https://haade.fr/assets/images/generated/nico-40-78aa7390f.jpg" alt="Nico"> </picture> </span> <span class="author-meta"> <a href="/en/author-nico"><span class="post-name font-weight-bold">Nico</span></a> <span class="meta-footer-thumb"><picture> <source srcset="https://haade.fr/assets/images/generated/august-40-be997cfb5.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/august-40-280b2576b.png 1.0x" type="image/png"> <img class="author-thumb" itemprop="image" width="40" height="40" src="https://haade.fr/assets/images/generated/august-40-280b2576b.png" alt="August"> </picture> </span> <span class="author-meta"> <a href="/en/author-august"><span class="post-name font-weight-bold">August</span></a> <span class="post-date">26<sup>th</sup>April 2024</span> </span><div class="clearfix"></div></div></div></div></div></div></div></div></div><footer><div class="footcontent"><div class="footleft footbox"><div class="footupper"><div class="foottopic">About</div><p>Haade is a blog intended to help individuals and professionals to set up a home automation system</p></div><div class="footlower"><div class="foottopic">Contact-us</div><div class="phone"> <a href="#"><i class="icos phone-volume-solid"></i>+0033 6 99 40 15 86</a></div><div class="email"> <a href="/en/contact"><i class="icos envelope-solid"></i>Confact form</a></div></div></div><div class="footmiddle footbox"><div class="foottopic">Useful links</div><div><a href="/en/gdpr">Privacy Policy</a></div><div><a href="/en/legal-notice">Legal notice</a></div><div><a target="_blank" href="https://buildwithmatter.com/">Protocole Matter</a></div><div><a target="_blank" href="https://zigbeealliance.org/fr/%C3%A9v%C3%A9nements/">Zigbee Alliance</a></div><div><a target="_blank" href="https://z-wavealliance.org/category/z-wave-in-the-news/">Z-wave Alliance</a></div><div><a target="_blank" href="https://www.aqara.com/eu/news.html">Aquara by Xiaomi</a></div><div><a target="_blank" href="https://itead.cc/">Itead Sonoff, Nextion</a></div></div><div class="footright footbox"><div class="foottopic">Subscribe to the newsletter</div><form action="https://haade.us4.list-manage.com/subscribe/post?u=86f32891957737a57c0b4ade8&amp;id=92dadba2b4" method="post" name="" class="" target="_blank" novalidate> <input type="text" placeholder="Enter email address"> <input type="submit" name="" value="Send"><div class="media-icons"> <a href="https://github.com/haade-administrator/haade.fr/discussions" target="_blank" alt="github discussion link" aria-label="Continue the discussion on the github forum"><i class="icob github" aria-hidden="true" title="github discussion"></i></a> <a target="_blank" href="https://www.youtube.com/channel/UCcXJ1ZsjEvQxuWJy7gH-A6w/?sub_confirmation=1" onclick="window.open(this.href, 'width=550,height=435');return false;" aria-label="Subscribe to our youtube channel"><i class="icob youtube" aria-hidden="true" title="youtube"></i></a> <a target="_blank" href="https://discord.gg/FaK6MuZ2" onclick="window.open(this.href, 'width=550,height=435');return false;" aria-label="Invitation to our Discord network"><i class="icob discord" aria-hidden="true" title="discord"></i></a> <a href="/en/feed.xml" target="_blank" alt="feed rss" aria-label="share the rss feed with your friends"><i class="icob rss" aria-hidden="true" title="feed rss haade"></i></a></div></form></div></div><div class="footbottom"><p>Copyright Â© 2024 <a target="_blank" href="https://www.haade.fr">Haade</a> ðŸŽ‰ by Nicoxygen</p></div></footer></div><script src="/assets/js/main.min.js?v=2b6bbb018bb501a889749f425d97675c" type="text/javascript"></script> <script src="/assets/js/lunrsearchengine-en.js?v=6debdc48922f8918a8d9a7cf53f61883"></script>
