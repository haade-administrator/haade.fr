<!DOCTYPE html><html lang="en-GB"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="icon" href="/assets/images/logo.png"><title>Domotizes the Itron water meter with esp and cc1101 in ha for 10€ - Haade.fr</title><meta name="description" content="Automate your itron water meter step by step equipped with a 433mhz everblu cyble sensor with arduino in homeassistant thanks to an esp8266/esp32 module and a TI cc1101 transmitter/receiver"><link rel="canonical" href="https://haade.fr/en/blog/automate-water-meter-itron-everblu-cyble"><link rel="alternate" hreflang="en" href="https://haade.fr/en/blog/automate-water-meter-itron-everblu-cyble"/><link rel="alternate" hreflang="fr" href="https://haade.fr/fr/blog/domotiser-compteur-eau-itron-everblu-cyble"/><meta property="og:locale" content="fr-FR"><meta property="og:type" content="article"><meta property="og:title" content="Domotizes the Itron water meter with esp and cc1101 in ha for 10€"><meta property="og:description" content="Automate your itron water meter step by step equipped with a 433mhz everblu cyble sensor with arduino in homeassistant thanks to an esp8266/esp32 module and a TI cc1101 transmitter/receiver"><meta property="og:url" content="https://haade.fr/en/blog/automate-water-meter-itron-everblu-cyble"><meta property="og:site_name" content="Haade.fr"><meta property="og:image" content="https://haade.fr/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt.png"><meta property="article:author" content=""><meta property="article:published_time" content="2022-12-21T13:08:00+01:00"><meta property="article:modified_time" content="2022-12-28T17:43:00+01:00"> <script type="application/ld+json"> { "@context": "https://schema.org", "@type": "BlogPosting", "url": "https://haade.fr/en/blog/automate-water-meter-itron-everblu-cyble", "name": "Domotizes the Itron water meter with esp and cc1101 in ha for 10€", "headline": "Domotizes the Itron water meter with esp and cc1101 in ha for 10€", "keywords": "Automation,Haade-lab,Home-Assistant,Esp", "description": "Automate your itron water meter step by step equipped with a 433mhz everblu cyble sensor with arduino in homeassistant thanks to an esp8266/esp32 module and a TI cc1101 transmitter/receiver", "articleBody": "Recently version 2022.11 of Homeassistant supports the water energy meter, it is possible to recover the data easily using esp and that for around 10€. In my case the meter is equipped with a 433Mhz Itron Everblu Cyble 2.1 transmitter. This makes it easy to retrieve data using a CC1101 receiver coupled to an esp8266/esp32. I picked up and modified a complete repository on github that was edited by psykokwak, and I commend his work. This repository allows data to be received and transferred by mqtt to homeassistant.\n\nPrerequisites\n\n an esp8266 card\n a CC1101 controller\n an Itron water meter equipped with an Itron Everblu cyble Enhanced transmitter Itron Everblu cyble\n home assistant v2022.11.0 mini\n\n\n\n \n \n \n \n \n\n\n \n \n \n wemos mini D1 pro esp module with antenna\n By Estardyn\n Renowned esp8266 development module wemos D1 mini pro with antenna to best capture wifi waves\n \n \n \n \n Buy Now\n \n \n\n\n\n\n \n \n \n \n \n\n\n \n \n \n CC1101 Wireless RF Transceiver Board Module, 315/433/868/915MHZ\n By Texas Instrument\n CC1101 Wireless RF Transceiver Board, SMA 315MHZ 433MHZ 868MHZ 915MHZ Antenna Module, 30ma GFSK MSK Modulation\n \n \n \n \n Buy Now\n \n \n\n\n\nArduino preparation\n\nInstall Arduino, being on linux I choose the appimage\nArduino Software\n\nInstallation of necessary libraries\n\n1. Library of ESP8266 and ESP32 cards\n\nLet’s start by installing the esp8266 and esp32 card management library:\n\nCard library esp8266\nCard library esp32\n\n\n File &gt; Preferences and paste the above url in Additional Map Manager URL\n\n\n\n\n\n Tools &gt; map &gt; map managers, search for esp8266 and esp32 and install the latest Espressif version\n\n\n\n2. Install the espmqttclient library\n\n\n Tools &gt; Manage Libraries, search for espmqttclient and install the latest version\n\n\n\n\nSelect the right card in my case a wemos d1 mini pro on usb port\n\n\n Connect your esp controller to USB\n In the add /dev/USB0 card drop-down menu, start by selecting the card and checking the corresponding port.\n Finally, Give permissions to the usb port\n\n\nsudo usermod -a -G dialout #USER\nsudo chmod a+rw /dev/ttyUSB0\n\n\n\nCréer un nouveau sketch et importer le dossier\n\nMethod 1:\nDownload the git, extract it and drag it to the sketch folder on the Arduino interface, otherwise drop the folder directly at the root of the Arduino folder.\n\nMethod 2: Command line\n\ncd /home/nicolas/Arduino // go to your arduino folder\ngit clone https://github.com/haade-administrator/watermeter2mqtt.git watermeter2mqtt\n\n\n \n \n \n \n Warning\n Please upload the folder with name: watermeter2mqtt\n \n click here git link\n \n\n\n\n\nConnection esp866 to CC011 in my case a Wemos D1 Mini\n\n\n \n \n CC1101\n Wemos D1 mini\n NodeMCU\n ESP32\n \n \n \n \n VCC\n 3v3\n 3v3\n 3v3\n \n \n GOD0 (GDO0)\n D1, GPIO 5\n GPIO 5\n GPIO 22\n \n \n CSN (SPI chip select CS or SS)\n D8, GPIO 15\n GPIO 15\n GPIO 5 ou GPIO 15\n \n \n SCK (SPI clock)\n D5, GPIO 14\n GPIO 14\n GPIO 18 ou GPIO 14\n \n \n MOSI (SPI MOSI)\n D7, GPIO 13\n GPIO 13\n GPIO 23 ou GPIO 13\n \n \n GOD1 (SPI MISO)\n D6, GPIO 12\n GPIO 12\n GPIO 19 ou GPIO 12\n \n \n GOD2 (GDO2)\n D2, GPIO 4\n GPIO 4\n GPIO 21\n \n \n GND (ground)\n G\n GND\n GND\n \n \n\n\n\n\n\n Pictures link NodeMcu Esp8266 GPIO\n Pictures link Gpio Esp32-30 pin\n Pictures link Gpio Esp32-30 pin\n\n\nLet’s set up the files before verification\n\nwatermeter2mqtt.ino file\n\n1 wifi and mqtt settings\n\nEspMQTTClient mqtt(\n &quot;MyESSID&quot;, // Your Wifi SSID\n &quot;MyWiFiKey&quot;, // Your WiFi key\n &quot;mqtt.server.com&quot;, // MQTT Broker server ip\n &quot;MQTTUsername&quot;, // Can be omitted if not needed\n &quot;MQTTPassword&quot;, // Can be omitted if not needed\n &quot;watermetter2mqtt&quot;, // Client name that uniquely identify your device\n 1883 // MQTT Broker server port\n);\n\n2 line 88-90 reading adjustment\n\n As a reminder, this code collects consumption data once a day during meter reader working hours.\n** Below I have set 2 p.m. UTC which corresponds to 3 p.m. France **\n\n\n// At 14:00 UTC\n if (ptm-&gt;tm_hour == 14 &amp;&amp; ptm-&gt;tm_min == 0 &amp;&amp; ptm-&gt;tm_sec == 0)\n\n3 choices of scheduled reading or at each data update\n\nBy default the script updates as soon as the data changes, just uncomment onScheduled line 257 to 259 and comment onUpdateData\n\n// Note: on scheduled allows you to read the information once a day, onUpdateData allows you to read each time information changes\n // onScheduled();\n onUpdateData();\n\n4 find the right frequency for your CC1101 transmitter\n\nJust uncomment the code line 272-291\n\n// Use this piece of code to find the right frequency.\n /*\n for (float i = 433.76f; i &lt; 433.890f; i += 0.0005f) {\n Serial.printf(&quot;Test frequency : %f\\n&quot;, i);\n cc1101_init(i);\n\n struct tmeter_data meter_data;\n meter_data = get_meter_data();\n\n if (meter_data.reads_counter != 0 || meter_data.liters != 0) {\n Serial.printf(&quot;\\n------------------------------\\nGot frequency : %f\\n------------------------------\\n&quot;, i);\n\n Serial.printf(&quot;Liters : %d\\nBattery (in months) : %d\\nCounter : %d\\n\\n&quot;, meter_data.liters, meter_data.battery_left, meter_data.reads_counter);\n\n digitalWrite(LED_BUILTIN, LOW); // turned on\n\n while (42);\n }\n }\n */\n\n\n\n cc1101_init(FREQUENCY);\n\n /*\n // Use this piece of code to test\n struct tmeter_data meter_data;\n meter_data = get_meter_data();\n Serial.printf(&quot;\\nLiters : %d\\nBattery (in months) : %d\\nCounter : %d\\nTime start : %d\\nTime end : %d\\n\\n&quot;, meter_data.liters, meter_data.battery_left, meter_data.reads_counter, meter_data.time_start, meter_data.time_end);\n while (42);\n */\n}\n\n\n\nPush the code to your module then select Serial Monitor:\n\n\n\nthe result should look like the image below:\n\n\n\n\n Once the code has been retrieved, remember to comment on these codes, otherwise you will not be able to upload the data later.\n\n\n5 Set the clock to your region (Optional)\n\nGo to line 188-190 if necessary\n\nconfigTzTime(&quot;CET-1CEST-2,M3.5.0/02:00:00,M10.5.0/03:00:00&quot;, &quot;pool.ntp.org&quot;);\n\nThe clock is set to Paris, to modify according to your region copy/paste the code available on this site\n\ncc1101.cpp file\n\nImportant step, match the connections of the CC1001 to the GPIO of the esp module:\n\nLet’s start by going back to the diagram available above, you will be able to realize that on a Wemos D1 for example that SCK corresponds to the GPIO14, Miso 12 etc… knowing that modifies lines 94 to 100 of the code available in this file. See the animated GIF below:\n\n\n\neverblu_meters.h file\n\nCode available on your itron module remember not to use the first 0.\n\n\n\nat the very bottom of the file line 53-60\n\n// Change these define according to your hardware\n\n#define FREQUENCY 433.8683f // frequency found above keep 4 digits after the dot and add f\n\n#define GDO0 5 // gpio 5 on GDO0\n\n#define METER_YEAR 15 // meter year\n#define METER_SERIAL 886451 // Serial code without the 0\n\nPush the project to the esp8266/esp32 module\n\nAll that remains is to validate the sketch project &gt; check/compile or Ctrl+R, and if everything went well you should have the result\n\nExecutable segment sizes:\nICACHE : 32768 - flash instruction cache \nIROM : 331192 - code in flash (default or ICACHE_FLASH_ATTR) \nIRAM : 28877 / 32768 - code in IRAM (IRAM_ATTR, ISRs...) \nDATA : 1620 ) - initialized variables (global, static) in RAM/HEAP \nRODATA : 6680 ) / 81920 - constants (global, static) in RAM/HEAP \nBSS : 26968 ) - zeroed variables (global, static) in RAM/HEAP \nLe croquis utilise 368369 octets (35%) de l&#39;espace de stockage de programmes. Le maximum est de 1044464 octets.\nLes variables globales utilisent 35268 octets (43%) de mémoire dynamique, ce qui laisse 46652 octets pour les variables locales. Le maximum est de 81920 octets.\n\nThen click upload: sketch &gt; upload or Ctrl+U\n\nresult:\n\nWrote 372528 bytes (266139 compressed) at 0x00000000 in 23.5 seconds (effective 126.9 kbit/s)...\nHash of data verified.\n\nLeaving...\nHard resetting via RTS pin...\n\nCheck serial monitor\n\nLast step upload the info in the energy meter\n\n\n In homeassistant go to Settings &gt; Dashboards &gt; Energies\n Add a water source\n Select Water meter index\n\n\n\n\nFinal result in energy consumption\n\n\n\nFrequently Asked Questions\n\nData characteristics and frequencies\n\nthis repository allows to retrieve:\n\n consumption volumes\n Everblu battery level\n the number of statements\n the time at which the readings were taken.\n\n\nThe device polls the counter once a day, every 24 hours, and retries every hour if the query fails.\nYour counter can be configured in such a way that it only listens to requests during the hours when the meter readers are working. This is to save the batteries of the modules. If you are unable to communicate with the meter, please try again during business hours (8:00 a.m. to 4:00 p.m.), Monday through Friday. As a general rule, try to set up your device only during business hours to avoid confusion.\n\nFrequency Calibration 433Mhz\n\nYour transceiver module may not be calibrated correctly, please change the frequency a little lower or higher and try again. You can use RTL-SDR to measure the necessary offset. You can uncomment the part of the code in the watermeter2mqtt.ino (see above), file which analyzes all frequencies around the meter frequency to find the correct one.\n\n\n \n \n \n \n \n\n\n \n \n \n wemos mini D1 pro esp module with antenna\n By Estardyn\n Renowned esp8266 development module wemos D1 mini pro with antenna to best capture wifi waves\n \n \n \n \n Buy Now\n \n \n\n\n\n\n \n \n \n \n \n\n\n \n \n \n CC1101 Wireless RF Transceiver Board Module, 315/433/868/915MHZ\n By Texas Instrument\n CC1101 Wireless RF Transceiver Board, SMA 315MHZ 433MHZ 868MHZ 915MHZ Antenna Module, 30ma GFSK MSK Modulation\n \n \n \n \n Buy Now\n \n \n\n\n\nConclusion\n\nThis is a simple method to set up, for those who are not equipped with an Itron Everblu Enhanced transmitter, there is another method which consists of putting an inductive sensor directly on the meter and connect it to an esp8266, this method is a little more restrictive because it will be necessary to have a source of energy near this meter in order to be able to supply the esp and the sensor with 5V, the price of the whole also oscillates around 10€, an excellent article is available here pieterbrinkman.com\n\n", "datePublished": "2022-12-21 13:08:00 +0100", "dateModified": "2022-12-28 17:43", "inLanguage": "en-GB", "author": { "@type": "Person", "name": null, "alternateName": null, "description": null, "url": null,"image": null,"email": null }, "publisher": { "@type": "Organization", "name": "Haade.fr", "url": "https://haade.fr", "logo": { "@type": "ImageObject", "width": 250, "height": 63, "url": "https://haade.fr/assets/images/logo.png" } }, "mainEntityOfPage": { "@type": "WebPage", "@id": "https://haade.fr/en/blog/automate-water-meter-itron-everblu-cyble" }, "image": { "@type": "ImageObject", "width": 250, "height": 94, "url": "https://haade.fr/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt.png" } } </script><link href="/assets/css/theme.css?v=1748402138805802854" media="screen, projection, print" rel="stylesheet"> <script data-goatcounter="https://haade.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script><link rel="preload" href="/assets/fonts/montserrat/Montserrat-VariableFont_wght.woff2" as="font" crossorigin><link rel="preload" href="/assets/fonts/icomoon/icomoon.woff2?4fpajq" as="font" crossorigin><link rel="shortcut icon" type="image/x-icon" href="/assets/images/favicon.ico" ><link rel="shortcut icon" type="image/png" href="/assets/images/favicon.png" ><header><div class="firstnavbar"><div class="links"> <a href="/en/">Home</a> <a href="/en/gdpr-general-data-protection-regulation/">GDPR</a> <a href="/en/contact/">Contact</a><div class="sl-nav"> language:<ul><li><b>English</b> <i class="ico angle-down-solid triangle-arrow trrow" aria-hidden="true"></i><div class="triangle"></div><ul class="show-flags"><li><a href="/fr/blog/domotiser-compteur-eau-itron-everblu-cyble"><i class="sl-flag fix flag-fr"><div id="Francais"></div></i><span class="active">Francais</span></a><li class="current"><a href="/en/blog/automate-water-meter-itron-everblu-cyble"><i class="sl-flag fix flag-england"><div id="English"></div></i><span class="active">English</span></a></ul></ul></div></div><div class="social-firstnav"> <a href="https://github.com/haade-administrator/haade.fr/discussions" target="_blank" alt="github discussion link" aria-label="Continue the discussion on the github forum"><i class="icob github" width="1em" height="1em" aria-hidden="true" title="github discussion"></i></a> <a href="https://www.youtube.com/channel/UCcXJ1ZsjEvQxuWJy7gH-A6w/?sub_confirmation=1" onclick="window.open(this.href, 'width=550,height=435');return false;" aria-label="Subscribe to our youtube channel"><i class="icob youtube" width="1em" height="1em" target="_blank" alt="youtube" aria-hidden="true" title="youtube"></i></a> <a href="https://discord.gg/FaK6MuZ2" onclick="window.open(this.href, 'width=550,height=435');return false;" aria-label="Invitation to our Discord network"><i class="icob discord" width="1em" height="1em" target="_blank" alt="discord" aria-hidden="true" title="discord"></i></a> <a href="/en/feed.xml" target="_blank" alt="feed rss" aria-label="share the rss feed with your friends"><i class="icob rss" width="1em" height="1em" aria-hidden="true" title="feed rss haade"></i></a></div></div><div class="secondheader"> <a class="navbar-brand" href="/en/"><picture> <source sizes="(max-width: 524px) 150px, 250px" srcset="https://haade.fr/assets/images/generated/logo-150-379587352.webp 150w, https://haade.fr/assets/images/generated/logo-250-379587352.webp 250w" type="image/webp"> <source sizes="(max-width: 524px) 150px, 250px" srcset="https://haade.fr/assets/images/generated/logo-150-64f85a78e.png 150w, https://haade.fr/assets/images/generated/logo-250-64f85a78e.png 250w" type="image/png"> <img id="logoIImage" src="https://haade.fr/assets/images/generated/logo-250-64f85a78e.png" alt="Logo officiel du site domotique Haade" width="250" height="94"> </picture> </a><p class="sitetag"> Home Assistance Alsace home automation & electronics.</p></div><nav id="nav"><div class="navbar"> <i class='icos bars-solid'></i><div class="nav-links"><div class="sidebar-logo"> <span class="logo-name">H2Ade</span> <i class='icos times-solid'></i></div><ul class="links"><li><a href="/en/">Home<span class="badge badge-light tags">147</span></a><li> <a href="https://haade.fr/en/category/automation">Automation</a> <i class="icos angle-down-solid htmlcss-arrow-automation arrow"></i><ul class="htmlCss-sub-menu-automation sub-menu"><li><a href="/en/category/security">Security</a><li class="more"> <span><a href="/en/category/haade-lab">Tutos</a> <i class='icos angle-right-solid arrow more-arrow-automation'></i> </span><ul class="more-sub-menu-automation sub-menu"><li><a href="/en/category/mini-tutos">Mini-tutorials</a><li><a href="/en/category/videos">Videos</a><li><a href="/en/category/home-assistant">Home-Assistant</a><li><a href="/en/category/jeedom">Jeedom</a></ul></ul><li><a href="/en/category/news">News</a><li><a href="/en/category/tests">Tests</a><li><a href="/en/authors">Contributors<span class="badge badge-primary">News</span></a><li><a target="_blank" href="https://github.com/haade-administrator/haade.fr/discussions">Forum</a><li><a href="/en/category-product/shop">Shop</a> <i class="icos angle-down-solid htmlcss-arrow-shop arrow"></i><ul class="htmlCss-sub-menu-shop sub-menu"><li class="more"> <span><a href="#">Brand</a> <i class='icos angle-right-solid arrow more-arrow-brand'></i> </span><ul class="more-sub-menu-brand sub-menu"><li><a href="/en/category-product/jeedom">Jeedom</a><li><a href="/en/category-product/moes">Moes</a><li><a href="/en/category-product/neo-coolcam">Neo-Coolcam</a><li><a href="/en/category-product/nodon">Nodon</a><li><a href="/en/category-product/raspberry-pi">Raspberry-pi</a><li><a href="/en/category-product/shelly">Shelly</a><li><a href="/en/category-product/sonoff">Sonoff</a><li><a href="/en/category-product/tedee">Tedee</a><li><a href="/en/category-product/xiaomi">Xiaomi</a><li><a href="/en/category-product/zemismart">Zemismart</a><li><a href="/en/category-product/zooz">Zooz</a></ul><li class="more"> <span><a href="#">Protocol</a> <i class='ico angle-right-solid arrow more-arrow-protocol'></i> </span><ul class="more-sub-menu-protocol sub-menu"><li><a href="/en/category-product/bluetooth">Bluetooth</a><li><a href="/en/category-product/esp">Esp 32/8266</a><li><a href="/en/category-product/matter">Matter</a><li><a href="/en/category-product/wifi">Wifi</a><li><a href="/en/category-product/zigbee">Zigbee</a><li><a href="/en/category-product/zwave">Z-wave</a></ul></ul><li><div class="sl-nav"> language:<ul><li><b>English</b> <i class="ico angle-down-solid triangle-arrow trrow" aria-hidden="true"></i><div class="triangle"></div><ul class="show-flags"><li><a href="/fr/blog/domotiser-compteur-eau-itron-everblu-cyble"><i class="sl-flag fix flag-fr"><div id="Francais"></div></i><span class="active">Francais</span></a><li class="current"><a href="/en/blog/automate-water-meter-itron-everblu-cyble"><i class="sl-flag fix flag-england"><div id="English"></div></i><span class="active">English</span></a></ul></ul></div></ul></div><script src="/assets/js/lunr.min.js?v=a944ea77ca394dff9a667d5aea56f0e9" type="text/javascript"></script><div class="search-box"> <i class='icos search-solid'></i><div class="input-box"> <form onSubmit="return lunr_search(document.getElementById('lunrsearch').value);" class="search-form" role="search"> <input autocomplete="on" id="lunrsearch" class="search-input" name="q" maxlength="200" placeholder="Search..." type="search" value=""> <input class="search-action" type="submit" value="Ok"> </form></div><div id="lunrsearchresults"><ul></ul></div></div></div></nav></header><div class="site-content"><div class="container"><div class="main-content"> <script> var addViews = "465"; var addViewsValue = parseInt(addViews); var r = new XMLHttpRequest(); r.addEventListener('load', function() { var visits = parseInt(JSON.parse(this.responseText).count.replace(/\s/g, '')); var totalVisits = visits; if (!isNaN(addViewsValue)) { totalVisits += addViewsValue; } document.getElementById('visits').innerText = totalVisits; }); r.open('GET', 'https://haade.goatcounter.com/counter/' + encodeURIComponent(location.pathname) + '.json'); r.send(); </script><div class="entry-header"><nav class="ariane"><ol class="arianefil" itemscope itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"> <a itemprop="item" href="https://haade.fr/en/"><span itemprop="name">Home</span></a><meta itemprop="position" content="1"><li><span class="prompt">&nbsp; > &nbsp;</span><li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" href="https://haade.fr/en/category/automation"><span itemprop="name">Automation</span></a><meta itemprop="position" content="2"><li><span class="prompt">&nbsp; > &nbsp;</span><li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" href="https://haade.fr/en/category/haade-lab"><span itemprop="name">Haade-lab</span></a><meta itemprop="position" content="3"><li><span class="prompt">&nbsp; > &nbsp;</span><li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" href="https://haade.fr/en/category/home-assistant"><span itemprop="name">Home-Assistant</span></a><meta itemprop="position" content="4"><li><span class="prompt">&nbsp; > &nbsp;</span>Domotizes the Itron water meter with esp and cc1101 in ha for 10€</ol></nav><h1 class="posttitle">Domotizes the Itron water meter with esp and cc1101 in ha for 10€</h1><div class="d-flex align-items-start mt-4"><div class="authorpost"> <a href="/en/author-nico"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-60-5d88b8595.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-60-c8508425c.png 1.0x" type="image/png"> <img class="author-thumb" itemprop="image" width="60" height="60" src="https://haade.fr/assets/images/generated/nico-60-c8508425c.png" alt="Nico"> </picture> </a> Writing by <a href="/en/author-nico"><b>Nico</b></a></div><div class="readingpost">&nbsp;<i class="icos calendar-check" width="1em" height="1em"></i> <time datetime="2022-12-28T17:43:00+01:00">28<sup>th</sup>December 2022 &nbsp; </time> <span><span class="reading-time" title="Estimated read time"> <i class="icos history" width="1em" height="1em"></i> <strong> 9 min</strong> of reading </span> </span><p><i class="icos eye-solid" width="1em" height="1em"></i> This page has been visited <span id="visits" style="font-weight:bold">...</span> times</p></div></div></div><div class="entry-featured-image"><picture> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) 800px, (min-width: 1025px) 940px, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-300-d5ecc5ca9.webp 300w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-400-d5ecc5ca9.webp 400w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-500-d5ecc5ca9.webp 500w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-600-d5ecc5ca9.webp 600w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-700-d5ecc5ca9.webp 700w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-800-d5ecc5ca9.webp 800w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-900-d5ecc5ca9.webp 900w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-940-d5ecc5ca9.webp 940w" type="image/webp"> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) 800px, (min-width: 1025px) 940px, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-300-d5ecc5ca9.png 300w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-400-d5ecc5ca9.png 400w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-500-d5ecc5ca9.png 500w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-600-d5ecc5ca9.png 600w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-700-d5ecc5ca9.png 700w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-800-d5ecc5ca9.png 800w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-900-d5ecc5ca9.png 900w, https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-940-d5ecc5ca9.png 940w" type="image/png"> <img class="lazyload featured-image-post" width="940" height="529" itemprop="image" src="https://haade.fr/assets/images/generated/posts/33/domotize-water-meter-itron-everblu-energy-homeassistant-mqtt-940-d5ecc5ca9.png" alt="Domotizes the Itron water meter with esp and cc1101 in ha for 10€"> </picture></div><div class="article-post"><p><em></em></p><div class="toc mt-4 mb-4 lead"><h3 class="font-weight-bold">Sommary</h3><ul class="table_of"><li class="toc"><a href="#prerequisites" class="toc_anchor">Prerequisites</a><li class="toc"><a href="#arduino-preparation" class="toc_anchor">Arduino preparation</a><ul class="toc_sub"><li class="toc"><a href="#install-arduino-being-on-linux-i-choose-the-appimage" class="toc_anchor">Install Arduino, being on linux I choose the appimage</a><li class="toc"><a href="#installation-of-necessary-libraries" class="toc_anchor">Installation of necessary libraries</a><li class="toc"><a href="#select-the-right-card-in-my-case-a-wemos-d1-mini-pro-on-usb-port" class="toc_anchor">Select the right card in my case a wemos d1 mini pro on usb port</a><li class="toc"><a href="#créer-un-nouveau-sketch-et-importer-le-dossier" class="toc_anchor">Créer un nouveau sketch et importer le dossier</a></ul></ul><li class="toc"><a href="#connection-esp866-to-cc011-in-my-case-a-wemos-d1-mini" class="toc_anchor">Connection esp866 to CC011 in my case a Wemos D1 Mini</a><li class="toc"><a href="#lets-set-up-the-files-before-verification" class="toc_anchor">Let’s set up the files before verification</a><li class="toc"><a href="#push-the-project-to-the-esp8266esp32-module" class="toc_anchor">Push the project to the esp8266/esp32 module</a><li class="toc"><a href="#last-step-upload-the-info-in-the-energy-meter" class="toc_anchor">Last step upload the info in the energy meter</a><ul class="toc_sub"><li class="toc"><a href="#final-result-in-energy-consumption" class="toc_anchor">Final result in energy consumption</a></ul></ul><li class="toc"><a href="#frequently-asked-questions" class="toc_anchor">Frequently Asked Questions</a><ul class="toc_sub"><li class="toc"><a href="#data-characteristics-and-frequencies" class="toc_anchor">Data characteristics and frequencies</a></ul></ul><li class="toc"><a href="#conclusion" class="toc_anchor">Conclusion</a></ul></div><div class="content-post"><p>Recently <em>version 2022.11 of Homeassistant supports the water energy meter</em>, it is possible to recover the data easily using esp and that <strong>for around 10€</strong>. In my case the meter is equipped with a 433Mhz Itron Everblu Cyble 2.1 transmitter. This makes it easy to retrieve data using a CC1101 receiver coupled to an esp8266/esp32. I picked up and <strong>modified</strong> a complete repository on github that was edited by <em>psykokwak</em>, and I commend his work. <a href="https://github.com/haade-administrator/watermeter2mqtt.git" target="_blank">This repository allows data to be received and transferred by mqtt to homeassistant</a>.</p><h1 id="prerequisites">Prerequisites</h1><ul><li>an <a href="/en/product/wemos-d1-mini-pro-with-antenna">esp8266 card</a><li>a <a href="/en/product/cc1101-receiver-radio-frequency-433mhz">CC1101 controller</a><li>an Itron water meter equipped with an Itron Everblu cyble Enhanced transmitter <a href="https://www.itron.com/fr/solutions/product-catalog/everblu-cyble-enhanced" target="_blank">Itron Everblu cyble</a><li>home assistant <a href="https://www.home-assistant.io/blog/2022/11/02/release-202211/#getting-insights-into-water-usage" target="_blank">v2022.11.0 mini</a></ul><div class="embedproduct"><div class="embedproduct-picture"><picture> <source sizes="(max-width: 480px) 250px, (max-width: 768px) 350px, (max-width: 1024px) 400px, (min-width: 1025px) 30vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-250-e66409c99.webp 250w, https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-350-e66409c99.webp 350w, https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-400-e66409c99.webp 400w, https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-444-e66409c99.webp 444w" type="image/webp" /> <source sizes="(max-width: 480px) 250px, (max-width: 768px) 350px, (max-width: 1024px) 400px, (min-width: 1025px) 30vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-250-e66409c99.jpg 250w, https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-350-e66409c99.jpg 350w, https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-400-e66409c99.jpg 400w, https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-444-e66409c99.jpg 444w" type="image/jpeg" /> <img class="lazyload" width="250" height="250" src="https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-400-e66409c99.jpg" alt="Renowned esp8266 development module wemos D1 mini pro with antenna to best capture wifi waves" /> </picture></div><div class="text"><div class="embedproduct-info"><h2 class="no_toc">wemos mini D1 pro esp module with antenna</h2><h3 class="no_toc">By Estardyn</h3><p>Renowned esp8266 development module wemos D1 mini pro with antenna to best capture wifi waves</p></div><div class="embedproduct-price"><div class="embedaffiliate"> <span class="haadebutton" role="button"><a href="/en/product/wemos-d1-mini-pro-with-antenna">Buy Now</a></span></div></div></div></div><div class="embedproduct"><div class="embedproduct-picture"><picture> <source sizes="(max-width: 480px) 250px, (max-width: 768px) 350px, (max-width: 1024px) 400px, (min-width: 1025px) 30vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/shop/2132/cc1101-250-18adc84a3.webp 250w, https://haade.fr/assets/images/generated/shop/2132/cc1101-350-18adc84a3.webp 350w, https://haade.fr/assets/images/generated/shop/2132/cc1101-400-18adc84a3.webp 400w, https://haade.fr/assets/images/generated/shop/2132/cc1101-444-18adc84a3.webp 444w" type="image/webp" /> <source sizes="(max-width: 480px) 250px, (max-width: 768px) 350px, (max-width: 1024px) 400px, (min-width: 1025px) 30vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/shop/2132/cc1101-250-18adc84a3.jpg 250w, https://haade.fr/assets/images/generated/shop/2132/cc1101-350-18adc84a3.jpg 350w, https://haade.fr/assets/images/generated/shop/2132/cc1101-400-18adc84a3.jpg 400w, https://haade.fr/assets/images/generated/shop/2132/cc1101-444-18adc84a3.jpg 444w" type="image/jpeg" /> <img class="lazyload" width="250" height="250" src="https://haade.fr/assets/images/generated/shop/2132/cc1101-400-18adc84a3.jpg" alt="CC1101 Wireless RF Transceiver Board, SMA 315MHZ 433MHZ 868MHZ 915MHZ Antenna Module, 30ma GFSK MSK Modulation" /> </picture></div><div class="text"><div class="embedproduct-info"><h2 class="no_toc">CC1101 Wireless RF Transceiver Board Module, 315/433/868/915MHZ</h2><h3 class="no_toc">By Texas Instrument</h3><p>CC1101 Wireless RF Transceiver Board, SMA 315MHZ 433MHZ 868MHZ 915MHZ Antenna Module, 30ma GFSK MSK Modulation</p></div><div class="embedproduct-price"><div class="embedaffiliate"> <span class="haadebutton" role="button"><a href="/en/product/cc1101-receiver-radio-frequency-433mhz">Buy Now</a></span></div></div></div></div><h1 id="arduino-preparation">Arduino preparation</h1><h3 id="install-arduino-being-on-linux-i-choose-the-appimage">Install Arduino, being on linux I choose the appimage</h3><p><a href="https://www.arduino.cc/en/software" target="_blank">Arduino Software</a></p><h3 id="installation-of-necessary-libraries">Installation of necessary libraries</h3><h4 id="1-library-of-esp8266-and-esp32-cards">1. Library of ESP8266 and ESP32 cards</h4><p>Let’s start by installing the esp8266 and esp32 card management library:</p><p><a href="http://arduino.esp8266.com/stable/package_esp8266com_index.json" target="_blank">Card library esp8266</a> <a href="https://dl.espressif.com/dl/package_esp32_index.json" target="_blank">Card library esp32</a></p><ul><li>File &gt; Preferences and paste the above url in Additional Map Manager URL</ul><p><img src="/assets/images/posts/33/add-preference-card-arduino.webp" alt="Map library installations" width="796" height="533" class="lazyload pictaninpost" /></p><ul><li>Tools &gt; map &gt; map managers, search for <strong>esp8266 and esp32</strong> and install the latest Espressif version</ul><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/add-esp8266-card-240-a2671b9d3.webp 240w, https://haade.fr/assets/images/generated/posts/33/add-esp8266-card-300-a2671b9d3.webp 300w, https://haade.fr/assets/images/generated/posts/33/add-esp8266-card-400-a2671b9d3.webp 400w, https://haade.fr/assets/images/generated/posts/33/add-esp8266-card-480-a2671b9d3.webp 480w, https://haade.fr/assets/images/generated/posts/33/add-esp8266-card-698-a2671b9d3.webp 698w, https://haade.fr/assets/images/generated/posts/33/add-esp8266-card-796-a2671b9d3.webp 796w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/add-esp8266-card-240-a2671b9d3.png 240w, https://haade.fr/assets/images/generated/posts/33/add-esp8266-card-300-a2671b9d3.png 300w, https://haade.fr/assets/images/generated/posts/33/add-esp8266-card-400-a2671b9d3.png 400w, https://haade.fr/assets/images/generated/posts/33/add-esp8266-card-480-a2671b9d3.png 480w, https://haade.fr/assets/images/generated/posts/33/add-esp8266-card-698-a2671b9d3.png 698w, https://haade.fr/assets/images/generated/posts/33/add-esp8266-card-796-a2671b9d3.png 796w" type="image/png" /><img class="pictinpost lazyload" width="796" height="533" src="https://haade.fr/assets/images/generated/posts/33/add-esp8266-card-240-a2671b9d3.png" alt="Installer librairies cartes esp8266" /></picture><h4 id="2-install-the-espmqttclient-library">2. Install the espmqttclient library</h4><ul><li>Tools &gt; Manage Libraries, search for espmqttclient and install the latest version</ul><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/add-esp-mqtt-client-240-ea3b27409.webp 240w, https://haade.fr/assets/images/generated/posts/33/add-esp-mqtt-client-300-ea3b27409.webp 300w, https://haade.fr/assets/images/generated/posts/33/add-esp-mqtt-client-400-ea3b27409.webp 400w, https://haade.fr/assets/images/generated/posts/33/add-esp-mqtt-client-480-ea3b27409.webp 480w, https://haade.fr/assets/images/generated/posts/33/add-esp-mqtt-client-698-ea3b27409.webp 698w, https://haade.fr/assets/images/generated/posts/33/add-esp-mqtt-client-796-ea3b27409.webp 796w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/add-esp-mqtt-client-240-ea3b27409.png 240w, https://haade.fr/assets/images/generated/posts/33/add-esp-mqtt-client-300-ea3b27409.png 300w, https://haade.fr/assets/images/generated/posts/33/add-esp-mqtt-client-400-ea3b27409.png 400w, https://haade.fr/assets/images/generated/posts/33/add-esp-mqtt-client-480-ea3b27409.png 480w, https://haade.fr/assets/images/generated/posts/33/add-esp-mqtt-client-698-ea3b27409.png 698w, https://haade.fr/assets/images/generated/posts/33/add-esp-mqtt-client-796-ea3b27409.png 796w" type="image/png" /><img class="pictinpost lazyload" width="796" height="533" src="https://haade.fr/assets/images/generated/posts/33/add-esp-mqtt-client-240-ea3b27409.png" alt="Add the espmqttclient library" /></picture><h3 id="select-the-right-card-in-my-case-a-wemos-d1-mini-pro-on-usb-port">Select the right card in my case a wemos d1 mini pro on usb port</h3><ol><li>Connect your esp controller to USB<li>In the add /dev/USB0 card drop-down menu, start by selecting the card and checking the corresponding port.<li>Finally, <strong>Give permissions to the usb port</strong></ol><figure class="highlight"><pre><code class="language-shell" data-lang="shell">sudo usermod -a -G dialout #USER
sudo chmod a+rw /dev/ttyUSB0</code></pre></figure><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/select-board-mcu-240-f1aa38be9.webp 240w, https://haade.fr/assets/images/generated/posts/33/select-board-mcu-300-f1aa38be9.webp 300w, https://haade.fr/assets/images/generated/posts/33/select-board-mcu-400-f1aa38be9.webp 400w, https://haade.fr/assets/images/generated/posts/33/select-board-mcu-480-f1aa38be9.webp 480w, https://haade.fr/assets/images/generated/posts/33/select-board-mcu-698-f1aa38be9.webp 698w, https://haade.fr/assets/images/generated/posts/33/select-board-mcu-796-f1aa38be9.webp 796w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/select-board-mcu-240-f1aa38be9.png 240w, https://haade.fr/assets/images/generated/posts/33/select-board-mcu-300-f1aa38be9.png 300w, https://haade.fr/assets/images/generated/posts/33/select-board-mcu-400-f1aa38be9.png 400w, https://haade.fr/assets/images/generated/posts/33/select-board-mcu-480-f1aa38be9.png 480w, https://haade.fr/assets/images/generated/posts/33/select-board-mcu-698-f1aa38be9.png 698w, https://haade.fr/assets/images/generated/posts/33/select-board-mcu-796-f1aa38be9.png 796w" type="image/png" /><img class="pictinpost lazyload" width="796" height="533" src="https://haade.fr/assets/images/generated/posts/33/select-board-mcu-240-f1aa38be9.png" alt="Select the esp8266 card" /></picture><h3 id="créer-un-nouveau-sketch-et-importer-le-dossier">Créer un nouveau sketch et importer le dossier</h3><p><strong>Method 1:</strong> <a href="https://github.com/haade-administrator/watermeter2mqtt.git" target="_blank">Download the git</a>, extract it and drag it to the sketch folder on the Arduino interface, otherwise drop the folder directly at the root of the Arduino folder.</p><p><strong>Method 2:</strong> Command line</p><figure class="highlight"><pre><code class="language-shell" data-lang="shell">cd /home/nicolas/Arduino // go to your arduino folder
git clone https://github.com/haade-administrator/watermeter2mqtt.git watermeter2mqtt</code></pre></figure><div class="alert alert-warning" role="alert"><div class="alert-icon"> <i class="icos exclamation-circle-solid"></i></div><div class="alert-text"><h4 class="no_toc">Warning</h4><p>Please upload the folder with name: <b>watermeter2mqtt</b></p><hr /> <a href="https://github.com/haade-administrator/watermeter2mqtt.git" target="_blank" class="alert-link">click here git link</a></div></div><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/folder-sketch-watermeter-240-4bb293a6f.webp 240w, https://haade.fr/assets/images/generated/posts/33/folder-sketch-watermeter-300-4bb293a6f.webp 300w, https://haade.fr/assets/images/generated/posts/33/folder-sketch-watermeter-400-4bb293a6f.webp 400w, https://haade.fr/assets/images/generated/posts/33/folder-sketch-watermeter-480-4bb293a6f.webp 480w, https://haade.fr/assets/images/generated/posts/33/folder-sketch-watermeter-698-4bb293a6f.webp 698w, https://haade.fr/assets/images/generated/posts/33/folder-sketch-watermeter-796-4bb293a6f.webp 796w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/folder-sketch-watermeter-240-4bb293a6f.png 240w, https://haade.fr/assets/images/generated/posts/33/folder-sketch-watermeter-300-4bb293a6f.png 300w, https://haade.fr/assets/images/generated/posts/33/folder-sketch-watermeter-400-4bb293a6f.png 400w, https://haade.fr/assets/images/generated/posts/33/folder-sketch-watermeter-480-4bb293a6f.png 480w, https://haade.fr/assets/images/generated/posts/33/folder-sketch-watermeter-698-4bb293a6f.png 698w, https://haade.fr/assets/images/generated/posts/33/folder-sketch-watermeter-796-4bb293a6f.png 796w" type="image/png" /><img class="pictinpost lazyload" width="796" height="533" src="https://haade.fr/assets/images/generated/posts/33/folder-sketch-watermeter-240-4bb293a6f.png" alt="Add watermeter2mqtt folder to arduino sketch" /></picture><h1 id="connection-esp866-to-cc011-in-my-case-a-wemos-d1-mini">Connection esp866 to CC011 in my case a Wemos D1 Mini</h1><table><thead><tr><th><a href="https://s.click.aliexpress.com/e/_DEK1jt9" target="_blank">CC1101</a><th><a href="https://s.click.aliexpress.com/e/_Dc6fzTD" target="_blank">Wemos D1 mini</a><th><a href="https://s.click.aliexpress.com/e/_DBOXniR" target="_blank">NodeMCU</a><th><a href="https://s.click.aliexpress.com/e/_DBOXniR" target="_blank">ESP32</a><tbody><tr><td>VCC<td>3v3<td>3v3<td>3v3<tr><td>GOD0 (GDO0)<td>D1, GPIO 5<td>GPIO 5<td>GPIO 22<tr><td>CSN (SPI chip select CS or SS)<td>D8, GPIO 15<td>GPIO 15<td>GPIO 5 ou GPIO 15<tr><td>SCK (SPI clock)<td>D5, GPIO 14<td>GPIO 14<td>GPIO 18 ou GPIO 14<tr><td>MOSI (SPI MOSI)<td>D7, GPIO 13<td>GPIO 13<td>GPIO 23 ou GPIO 13<tr><td>GOD1 (SPI MISO)<td>D6, GPIO 12<td>GPIO 12<td>GPIO 19 ou GPIO 12<tr><td>GOD2 (GDO2)<td>D2, GPIO 4<td>GPIO 4<td>GPIO 21<tr><td>GND (ground)<td>G<td>GND<td>GND</table><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/d1-mini-gpio-240-d24a9232b.webp 240w, https://haade.fr/assets/images/generated/posts/33/d1-mini-gpio-300-d24a9232b.webp 300w, https://haade.fr/assets/images/generated/posts/33/d1-mini-gpio-400-d24a9232b.webp 400w, https://haade.fr/assets/images/generated/posts/33/d1-mini-gpio-480-d24a9232b.webp 480w, https://haade.fr/assets/images/generated/posts/33/d1-mini-gpio-698-d24a9232b.webp 698w, https://haade.fr/assets/images/generated/posts/33/d1-mini-gpio-820-d24a9232b.webp 820w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/d1-mini-gpio-240-d24a9232b.png 240w, https://haade.fr/assets/images/generated/posts/33/d1-mini-gpio-300-d24a9232b.png 300w, https://haade.fr/assets/images/generated/posts/33/d1-mini-gpio-400-d24a9232b.png 400w, https://haade.fr/assets/images/generated/posts/33/d1-mini-gpio-480-d24a9232b.png 480w, https://haade.fr/assets/images/generated/posts/33/d1-mini-gpio-698-d24a9232b.png 698w, https://haade.fr/assets/images/generated/posts/33/d1-mini-gpio-820-d24a9232b.png 820w" type="image/png" /><img class="pictinpost lazyload" width="891" height="430" src="https://haade.fr/assets/images/generated/posts/33/d1-mini-gpio-240-d24a9232b.png" alt="GPIO Wemos d1 mini pin" /></picture><ol><li><a href="https://raw.githubusercontent.com/AchimPieters/ESP8266-12F---Power-Mode/master/Node-MCU-Pinout.png">Pictures link NodeMcu Esp8266 GPIO</a><li><a href="https://raw.githubusercontent.com/AchimPieters/esp32-homekit-camera/master/Images/ESP32-30PIN-DEVBOARD.png">Pictures link Gpio Esp32-30 pin</a><li><a href="https://raw.githubusercontent.com/AchimPieters/esp32-homekit-camera/master/Images/ESP32-38%20PIN-DEVBOARD.png">Pictures link Gpio Esp32-30 pin</a></ol><h1 id="lets-set-up-the-files-before-verification">Let’s set up the files before verification</h1><h4 id="watermeter2mqttino-file">watermeter2mqtt.ino file</h4><p><strong>1 wifi and mqtt settings</strong></p><figure class="highlight"><pre><code class="language-yaml" data-lang="yaml">EspMQTTClient mqtt(
  &quot;MyESSID&quot;,            // Your Wifi SSID
  &quot;MyWiFiKey&quot;,          // Your WiFi key
  &quot;mqtt.server.com&quot;,    // MQTT Broker server ip
  &quot;MQTTUsername&quot;,       // Can be omitted if not needed
  &quot;MQTTPassword&quot;,       // Can be omitted if not needed
  &quot;watermetter2mqtt&quot;,      // Client name that uniquely identify your device
  1883                  // MQTT Broker server port
);</code></pre></figure><p><strong>2 line 88-90 reading adjustment</strong></p><blockquote><p>As a reminder, this code collects consumption data once a day during meter reader working hours. ** Below I have set 2 p.m. UTC which corresponds to 3 p.m. France **</p></blockquote><figure class="highlight"><pre><code class="language-yaml" data-lang="yaml">// At 14:00 UTC
  if (ptm-&gt;tm_hour == 14 &amp;&amp; ptm-&gt;tm_min == 0 &amp;&amp; ptm-&gt;tm_sec == 0)</code></pre></figure><p><strong>3 choices of scheduled reading or at each data update</strong></p><p>By default the script updates as soon as the data changes, just uncomment onScheduled line 257 to 259 and comment onUpdateData</p><figure class="highlight"><pre><code class="language-yaml" data-lang="yaml">// Note: on scheduled allows you to read the information once a day, onUpdateData allows you to read each time information changes
 // onScheduled();
  onUpdateData();</code></pre></figure><p><strong>4 find the right frequency for your CC1101 transmitter</strong></p><p>Just uncomment the code line 272-291</p><figure class="highlight"><pre><code class="language-yaml" data-lang="yaml">// Use this piece of code to find the right frequency.
  /*
  for (float i = 433.76f; i &lt; 433.890f; i += 0.0005f) {
    Serial.printf(&quot;Test frequency : %f\n&quot;, i);
    cc1101_init(i);

    struct tmeter_data meter_data;
    meter_data = get_meter_data();

    if (meter_data.reads_counter != 0 || meter_data.liters != 0) {
      Serial.printf(&quot;\n------------------------------\nGot frequency : %f\n------------------------------\n&quot;, i);

      Serial.printf(&quot;Liters : %d\nBattery (in months) : %d\nCounter : %d\n\n&quot;, meter_data.liters, meter_data.battery_left, meter_data.reads_counter);

      digitalWrite(LED_BUILTIN, LOW); // turned on

      while (42);
    }
  }
  */



  cc1101_init(FREQUENCY);

  /*
  // Use this piece of code to test
  struct tmeter_data meter_data;
  meter_data = get_meter_data();
  Serial.printf(&quot;\nLiters : %d\nBattery (in months) : %d\nCounter : %d\nTime start : %d\nTime end : %d\n\n&quot;, meter_data.liters, meter_data.battery_left, meter_data.reads_counter, meter_data.time_start, meter_data.time_end);
  while (42);
  */
}</code></pre></figure><p><img src="/assets/images/posts/33/frequence-found.webp" alt="Find the right frequency corresponding to the Everblu module" width="838" height="613" class="lazyload pictaninpost" /></p><p>Push the code to your module then select Serial Monitor:</p><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/select-monitor-serie-240-ad49b1c1e.webp 240w, https://haade.fr/assets/images/generated/posts/33/select-monitor-serie-300-ad49b1c1e.webp 300w, https://haade.fr/assets/images/generated/posts/33/select-monitor-serie-400-ad49b1c1e.webp 400w, https://haade.fr/assets/images/generated/posts/33/select-monitor-serie-480-ad49b1c1e.webp 480w, https://haade.fr/assets/images/generated/posts/33/select-monitor-serie-698-ad49b1c1e.webp 698w, https://haade.fr/assets/images/generated/posts/33/select-monitor-serie-820-ad49b1c1e.webp 820w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/select-monitor-serie-240-ad49b1c1e.png 240w, https://haade.fr/assets/images/generated/posts/33/select-monitor-serie-300-ad49b1c1e.png 300w, https://haade.fr/assets/images/generated/posts/33/select-monitor-serie-400-ad49b1c1e.png 400w, https://haade.fr/assets/images/generated/posts/33/select-monitor-serie-480-ad49b1c1e.png 480w, https://haade.fr/assets/images/generated/posts/33/select-monitor-serie-698-ad49b1c1e.png 698w, https://haade.fr/assets/images/generated/posts/33/select-monitor-serie-820-ad49b1c1e.png 820w" type="image/png" /><img class="pictinpost lazyload" width="1115" height="577" src="https://haade.fr/assets/images/generated/posts/33/select-monitor-serie-240-ad49b1c1e.png" alt="Select serial monitor on arduino ide" /></picture><p>the result should look like the image below:</p><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/found-good-frequence-240-b202e5e11.webp 240w, https://haade.fr/assets/images/generated/posts/33/found-good-frequence-300-b202e5e11.webp 300w, https://haade.fr/assets/images/generated/posts/33/found-good-frequence-323-b202e5e11.webp 323w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/found-good-frequence-240-b202e5e11.png 240w, https://haade.fr/assets/images/generated/posts/33/found-good-frequence-300-b202e5e11.png 300w, https://haade.fr/assets/images/generated/posts/33/found-good-frequence-323-b202e5e11.png 323w" type="image/png" /><img class="pictinpost lazyload" width="323" height="363" src="https://haade.fr/assets/images/generated/posts/33/found-good-frequence-240-b202e5e11.png" alt="Finding the right connection frequency to the itron everblu cyble module" /></picture><blockquote><p>Once the code has been retrieved, remember to comment on these codes, otherwise you will not be able to upload the data later.</p></blockquote><p><strong>5 Set the clock to your region</strong> <em>(Optional)</em></p><p>Go to line 188-190 <em>if necessary</em></p><figure class="highlight"><pre><code class="language-yaml" data-lang="yaml">configTzTime(&quot;CET-1CEST-2,M3.5.0/02:00:00,M10.5.0/03:00:00&quot;, &quot;pool.ntp.org&quot;);</code></pre></figure><p><em>The clock is set to Paris</em>, to modify according to your region <a href="https://sites.google.com/a/usapiens.com/opnode/time-zones" target="_blank">copy/paste the code available on this site</a></p><h4 id="cc1101cpp-file">cc1101.cpp file</h4><p>Important step, match the connections of the CC1001 to the GPIO of the esp module:</p><p>Let’s start by going back to <a href="/en/blog/automate-water-meter-itron-everblu-cyble#connection-esp866-to-cc011-in-my-case-a-wemos-d1-mini">the diagram available above</a>, you will be able to realize that on a Wemos D1 for example that SCK corresponds to the GPIO14, Miso 12 etc… knowing that modifies lines 94 to 100 of the code available in this file. See the animated GIF below:</p><p><img src="/assets/images/posts/33/define-pin-cc1101-esp8266.webp" alt="Configure the connections of the CC1101 to the Wemos" width="529" height="298" class="lazyload pictaninpost" /></p><h4 id="everblu_metersh-file">everblu_meters.h file</h4><p>Code available on your itron module <strong>remember not to use the first 0</strong>.</p><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/itron-everblu-code-240-4fbc78ab9.webp 240w, https://haade.fr/assets/images/generated/posts/33/itron-everblu-code-300-4fbc78ab9.webp 300w, https://haade.fr/assets/images/generated/posts/33/itron-everblu-code-400-4fbc78ab9.webp 400w, https://haade.fr/assets/images/generated/posts/33/itron-everblu-code-480-4fbc78ab9.webp 480w, https://haade.fr/assets/images/generated/posts/33/itron-everblu-code-550-4fbc78ab9.webp 550w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/itron-everblu-code-240-4fbc78ab9.png 240w, https://haade.fr/assets/images/generated/posts/33/itron-everblu-code-300-4fbc78ab9.png 300w, https://haade.fr/assets/images/generated/posts/33/itron-everblu-code-400-4fbc78ab9.png 400w, https://haade.fr/assets/images/generated/posts/33/itron-everblu-code-480-4fbc78ab9.png 480w, https://haade.fr/assets/images/generated/posts/33/itron-everblu-code-550-4fbc78ab9.png 550w" type="image/png" /><img class="pictinpost lazyload" width="550" height="448" src="https://haade.fr/assets/images/generated/posts/33/itron-everblu-code-240-4fbc78ab9.png" alt="Find itron Everblu codes" /></picture><p>at the very bottom of the file line 53-60</p><figure class="highlight"><pre><code class="language-yaml" data-lang="yaml">// Change these define according to your hardware

#define FREQUENCY 433.8683f  // frequency found above keep 4 digits after the dot and add f

#define GDO0 5 // gpio 5 on GDO0

#define METER_YEAR              15 // meter year
#define METER_SERIAL            886451 // Serial code without the 0</code></pre></figure><h1 id="push-the-project-to-the-esp8266esp32-module">Push the project to the esp8266/esp32 module</h1><p>All that remains is to validate the sketch project &gt; check/compile or Ctrl+R, and if everything went well you should have the result</p><figure class="highlight"><pre><code class="language-shell" data-lang="shell">Executable segment sizes:
ICACHE : 32768           - flash instruction cache 
IROM   : 331192          - code in flash         (default or ICACHE_FLASH_ATTR) 
IRAM   : 28877   / 32768 - code in IRAM          (IRAM_ATTR, ISRs...) 
DATA   : 1620  )         - initialized variables (global, static) in RAM/HEAP 
RODATA : 6680  ) / 81920 - constants             (global, static) in RAM/HEAP 
BSS    : 26968 )         - zeroed variables      (global, static) in RAM/HEAP 
Le croquis utilise 368369 octets (35%) de l&#39;espace de stockage de programmes. Le maximum est de 1044464 octets.
Les variables globales utilisent 35268 octets (43%) de mémoire dynamique, ce qui laisse 46652 octets pour les variables locales. Le maximum est de 81920 octets.</code></pre></figure><p>Then click upload: sketch &gt; upload or Ctrl+U</p><p>result:</p><figure class="highlight"><pre><code class="language-shell" data-lang="shell">Wrote 372528 bytes (266139 compressed) at 0x00000000 in 23.5 seconds (effective 126.9 kbit/s)...
Hash of data verified.

Leaving...
Hard resetting via RTS pin...</code></pre></figure><p><strong>Check serial monitor</strong></p><h1 id="last-step-upload-the-info-in-the-energy-meter">Last step upload the info in the energy meter</h1><ol><li>In homeassistant go to Settings &gt; Dashboards &gt; Energies<li>Add a water source<li>Select Water meter index</ol><p><img src="/assets/images/posts/33/parameter-watermeter-energy-ha.webp" alt="Configure Water consumption in ha energy" width="657" height="287" class="lazyload pictaninpost" /></p><h3 id="final-result-in-energy-consumption">Final result in energy consumption</h3><picture><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/conso-energie-ha-240-a0085b2fb.webp 240w, https://haade.fr/assets/images/generated/posts/33/conso-energie-ha-300-a0085b2fb.webp 300w, https://haade.fr/assets/images/generated/posts/33/conso-energie-ha-400-a0085b2fb.webp 400w, https://haade.fr/assets/images/generated/posts/33/conso-energie-ha-480-a0085b2fb.webp 480w, https://haade.fr/assets/images/generated/posts/33/conso-energie-ha-600-a0085b2fb.webp 600w" type="image/webp" /><source sizes="(max-width: 480px) 480px, (max-width: 768px) 698px, (max-width: 1024px) 820px, (min-width: 1025px) 820px" srcset="https://haade.fr/assets/images/generated/posts/33/conso-energie-ha-240-a0085b2fb.png 240w, https://haade.fr/assets/images/generated/posts/33/conso-energie-ha-300-a0085b2fb.png 300w, https://haade.fr/assets/images/generated/posts/33/conso-energie-ha-400-a0085b2fb.png 400w, https://haade.fr/assets/images/generated/posts/33/conso-energie-ha-480-a0085b2fb.png 480w, https://haade.fr/assets/images/generated/posts/33/conso-energie-ha-600-a0085b2fb.png 600w" type="image/png" /><img class="pictinpost lazyload" width="600" height="400" src="https://haade.fr/assets/images/generated/posts/33/conso-energie-ha-240-a0085b2fb.png" alt="Final result in energy consumption tab" /></picture><h1 id="frequently-asked-questions">Frequently Asked Questions</h1><h3 id="data-characteristics-and-frequencies">Data characteristics and frequencies</h3><p>this repository allows to retrieve:</p><ol><li>consumption volumes<li>Everblu battery level<li>the number of statements<li>the time at which the readings were taken.</ol><p>The device polls the counter once a day, every 24 hours, and retries every hour if the query fails. Your counter can be configured in such a way that it only listens to requests during the hours when the meter readers are working. <strong>This is to save the batteries of the modules</strong>. If you are unable to communicate with the meter, please try again during business hours (8:00 a.m. to 4:00 p.m.), Monday through Friday. As a general rule, try to set up your device only during business hours to avoid confusion.</p><h4 id="frequency-calibration-433mhz">Frequency Calibration 433Mhz</h4><p>Your transceiver module may not be calibrated correctly, please change the frequency a little lower or higher and try again. You can use RTL-SDR to measure the necessary offset. You can uncomment the part of the code in the watermeter2mqtt.ino (see above), file which analyzes all frequencies around the meter frequency to find the correct one.</p><div class="embedproduct"><div class="embedproduct-picture"><picture> <source sizes="(max-width: 480px) 250px, (max-width: 768px) 350px, (max-width: 1024px) 400px, (min-width: 1025px) 30vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-250-e66409c99.webp 250w, https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-350-e66409c99.webp 350w, https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-400-e66409c99.webp 400w, https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-444-e66409c99.webp 444w" type="image/webp" /> <source sizes="(max-width: 480px) 250px, (max-width: 768px) 350px, (max-width: 1024px) 400px, (min-width: 1025px) 30vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-250-e66409c99.jpg 250w, https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-350-e66409c99.jpg 350w, https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-400-e66409c99.jpg 400w, https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-444-e66409c99.jpg 444w" type="image/jpeg" /> <img class="lazyload" width="250" height="250" src="https://haade.fr/assets/images/generated/shop/2131/WEMOS-Micro-carte-de-Developpement-WIFI-Connecteur-d-Antenne-Externe-Bas-sur-NodeMCU-D1-Mini-400-e66409c99.jpg" alt="Renowned esp8266 development module wemos D1 mini pro with antenna to best capture wifi waves" /> </picture></div><div class="text"><div class="embedproduct-info"><h2 class="no_toc">wemos mini D1 pro esp module with antenna</h2><h3 class="no_toc">By Estardyn</h3><p>Renowned esp8266 development module wemos D1 mini pro with antenna to best capture wifi waves</p></div><div class="embedproduct-price"><div class="embedaffiliate"> <span class="haadebutton" role="button"><a href="/en/product/wemos-d1-mini-pro-with-antenna">Buy Now</a></span></div></div></div></div><div class="embedproduct"><div class="embedproduct-picture"><picture> <source sizes="(max-width: 480px) 250px, (max-width: 768px) 350px, (max-width: 1024px) 400px, (min-width: 1025px) 30vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/shop/2132/cc1101-250-18adc84a3.webp 250w, https://haade.fr/assets/images/generated/shop/2132/cc1101-350-18adc84a3.webp 350w, https://haade.fr/assets/images/generated/shop/2132/cc1101-400-18adc84a3.webp 400w, https://haade.fr/assets/images/generated/shop/2132/cc1101-444-18adc84a3.webp 444w" type="image/webp" /> <source sizes="(max-width: 480px) 250px, (max-width: 768px) 350px, (max-width: 1024px) 400px, (min-width: 1025px) 30vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/shop/2132/cc1101-250-18adc84a3.jpg 250w, https://haade.fr/assets/images/generated/shop/2132/cc1101-350-18adc84a3.jpg 350w, https://haade.fr/assets/images/generated/shop/2132/cc1101-400-18adc84a3.jpg 400w, https://haade.fr/assets/images/generated/shop/2132/cc1101-444-18adc84a3.jpg 444w" type="image/jpeg" /> <img class="lazyload" width="250" height="250" src="https://haade.fr/assets/images/generated/shop/2132/cc1101-400-18adc84a3.jpg" alt="CC1101 Wireless RF Transceiver Board, SMA 315MHZ 433MHZ 868MHZ 915MHZ Antenna Module, 30ma GFSK MSK Modulation" /> </picture></div><div class="text"><div class="embedproduct-info"><h2 class="no_toc">CC1101 Wireless RF Transceiver Board Module, 315/433/868/915MHZ</h2><h3 class="no_toc">By Texas Instrument</h3><p>CC1101 Wireless RF Transceiver Board, SMA 315MHZ 433MHZ 868MHZ 915MHZ Antenna Module, 30ma GFSK MSK Modulation</p></div><div class="embedproduct-price"><div class="embedaffiliate"> <span class="haadebutton" role="button"><a href="/en/product/cc1101-receiver-radio-frequency-433mhz">Buy Now</a></span></div></div></div></div><h1 id="conclusion">Conclusion</h1><p>This is a simple method to set up, for those who are not equipped with an Itron Everblu Enhanced transmitter, there is another method which consists of putting an <a href="/en/product/inductive-sensor-5v-npn-LJ18A3-8Z" target="_blank">inductive sensor</a> directly on the meter and connect it to an esp8266, this method is a little more restrictive because it will be necessary to have a source of energy near this meter in order to be able to supply the esp and the sensor with 5V, the price of the whole also oscillates around 10€, an excellent article is available here <a href="https://www.pieterbrinkman.com/2022/02/02/build-a-cheap-water-usage-sensor-using-esphome-home-assistant-and-a-proximity-sensor/" target="_blank">pieterbrinkman.com</a></p></div></div><div class="sourcelink"> <span class="titlesource">Source posts</span><ol><li class="contentlink"> <a rel="canonical" href="https://github.com/psykokwak-com/everblu-meters-esp8266" target="_blank">github.com</a><i class="icos external-link-alt-solid"></i><li class="contentlink"> <a rel="canonical" href="https://fr.macerobotics.com/developpeur/tutoriels/programmer-le-microcontroleur-esp8266-avec-lide-arduino/" target="_blank">fr.macerobotics.com</a><i class="icos external-link-alt-solid"></i><li class="contentlink"> <a rel="canonical" href="https://sites.google.com/a/usapiens.com/opnode/time-zones" target="_blank">sites.google.com</a><i class="icos external-link-alt-solid"></i><li class="contentlink"> <a rel="canonical" href="https://www.pieterbrinkman.com/2022/02/02/build-a-cheap-water-usage-sensor-using-esphome-home-assistant-and-a-proximity-sensor" target="_blank">www.pieterbrinkman.com</a><i class="icos external-link-alt-solid"></i></ol></div><div class="authorbox mb-5 mt-5 pt-4 pb-4" itemscope itemtype="https://schema.org/Person"><div class="row"><div class="wrapavname col-md-3 text-center"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-110-5d88b8595.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-110-c8508425c.png 1.0x" type="image/png"> <img class="author-thumb" itemprop="image" width="110" height="110" src="https://haade.fr/assets/images/generated/nico-110-c8508425c.png" alt="Nico"> </picture><p class="mt-4 mb-0 small text-center"> <a target="_blank" class="d-inline-block mx-1 text-dark" itemprop="url" href="/fr/auteur-nico/"><i class="ico link-solid"></i></a> <a target="_blank" class="d-inline-block mx-1 text-dark" itemprop="sameAs" href="https://www.youtube.com/channel/UCcXJ1ZsjEvQxuWJy7gH-A6w"><i class="icob youtube"></i></a> <a target="_blank" class="d-inline-block mx-1 text-dark" itemprop="sameAs" href="https://github.com/haade-administrator"><i class="icob github"></i></a> <a target="_blank" class="d-inline-block mx-1 text-dark" itemprop="sameAs" href="https://discordapp.com/widget?id=637642871738073091&theme=dark&username=Nicoxygen#5644"><i class="icob discord"></i></a> <a class="d-inline-block mx-1 text-dark" itemprop="email" href="mailto:nico@haade.fr"><i class="ico envelope-solid"></i></a></p></div><div class="col-md-9"><h4 itemprop="name">Nico</h4><p class="mt-3 mb-0" itemprop="description">Founding member of the Haade website, I have been passionate about home automation, computers and electronics for over 10 years. Through this blog, I try to help other Internet users to experiment with home automation, to find fun tutorials, in short to evolve.</p></div></div></div><div class="comments mt-5"> <button class="btn btn-outline-dark py-2 px-5 d-block w-100 show-comments"><i class="ico comments-solid text-muted"></i> &nbsp; Load the Comments</button><div id="comments"><h4 class="mb-4">Comments</h4><script src="https://giscus.app/client.js" data-repo=haade-administrator/haade.fr data-repo-id=R_kgDOHxeeuA data-category=Comments data-category-id=DIC_kwDOHxeeuM4CTn1C data-mapping=title data-strict=1 data-reactions-enabled=1 data-emit-metadata=0 data-theme=light data-input-position=top data-loading=lazy data-lang=en crossorigin=anonymous async> </script><div class="clearfix"></div></div></div><div class=" related-posts"><h2 class="text-center mb-4">Articles that might interest you</h2><div class="d-flex justify-content-center align-items-center"> <a class="smoothscroll badge badge-primary text-capitalize" href="/en/category/automation">Automation</a> <a class="smoothscroll badge badge-primary text-capitalize" href="/en/category/haade-lab">Haade-lab</a> <a class="smoothscroll badge badge-primary text-capitalize" href="/en/category/home-assistant">Home-Assistant</a> <a class="smoothscroll badge badge-primary text-capitalize" href="/en/category/esp">Esp</a></div><div class="blog-grid-container"><div class="blog-grid-item"><div class="card h-100"><div class="maxthumb"> <a href="/en/blog/comparison-camera-sonoff-cam-slim-vs-cam-slim-gen-2-which-to-choose"><picture> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-300-ff2b80a3e.webp 300w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-400-ff2b80a3e.webp 400w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-500-ff2b80a3e.webp 500w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-600-ff2b80a3e.webp 600w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-700-ff2b80a3e.webp 700w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-800-ff2b80a3e.webp 800w" type="image/webp"> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-300-ff2b80a3e.png 300w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-400-ff2b80a3e.png 400w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-500-ff2b80a3e.png 500w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-600-ff2b80a3e.png 600w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-700-ff2b80a3e.png 700w, https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-800-ff2b80a3e.png 800w" type="image/png"> <img class="img-thumb lazyload" src="https://haade.fr/assets/images/generated/posts/160/comparatif-camera-sonoff-cam-slim-vs-cam-slim-gen-2-laquelle-choisir-800-ff2b80a3e.png" alt="Cam Slim VS Gen 2 Sonoff Comparison" width="1200" height="675"> </picture> </a></div><div class="card-body"><h2 class="card-title"> <a class="text-dark" href="/en/blog/comparison-camera-sonoff-cam-slim-vs-cam-slim-gen-2-which-to-choose">Cam Slim VS Gen 2 Sonoff Comparison</a><div class="mb-2 mt-2 font-weight-normal"><div class="rating-holder"><div class="Stars" style="--rating: 4.8; --star-background: #FF6600" title="Rating of this product is 4.8 out of 5."></div></div></div></h2><p class="card-text">Today, let’s compare the two currently available Sonoff cameras for less than €30 from all our affiliated retailers. I’d like to thank Domadoo and Itead for providing me with this...</p></div><div class="card-footer bg-white"><div class="wrapfooter"> <span class="meta-footer-thumb"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-40-5d88b8595.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-40-c8508425c.png 1.0x" type="image/png"> <img class="author-thumb" itemprop="image" width="40" height="40" src="https://haade.fr/assets/images/generated/nico-40-c8508425c.png" alt="Nico"> </picture> </span> <span class="author-meta"> <a href="/en/author-nico"><span class="post-name font-weight-bold">Nico</span></a> <span class="post-date"> 2<sup>nd</sup>April 2025</span> </span><div class="clearfix"></div></div></div></div></div><div class="blog-grid-item"><div class="card h-100"><div class="maxthumb"> <a href="/en/blog/tado-which-starter-kit-to-choose-presentation-comparison-and-protocol"><picture> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/158/tado-which-starter-kit-to-choose-presentation-and-comparison-300-679be727f.webp 300w, https://haade.fr/assets/images/generated/posts/158/tado-which-starter-kit-to-choose-presentation-and-comparison-400-679be727f.webp 400w, https://haade.fr/assets/images/generated/posts/158/tado-which-starter-kit-to-choose-presentation-and-comparison-500-679be727f.webp 500w, https://haade.fr/assets/images/generated/posts/158/tado-which-starter-kit-to-choose-presentation-and-comparison-600-679be727f.webp 600w, https://haade.fr/assets/images/generated/posts/158/tado-which-starter-kit-to-choose-presentation-and-comparison-700-679be727f.webp 700w, https://haade.fr/assets/images/generated/posts/158/tado-which-starter-kit-to-choose-presentation-and-comparison-800-679be727f.webp 800w" type="image/webp"> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/158/tado-which-starter-kit-to-choose-presentation-and-comparison-300-679be727f.png 300w, https://haade.fr/assets/images/generated/posts/158/tado-which-starter-kit-to-choose-presentation-and-comparison-400-679be727f.png 400w, https://haade.fr/assets/images/generated/posts/158/tado-which-starter-kit-to-choose-presentation-and-comparison-500-679be727f.png 500w, https://haade.fr/assets/images/generated/posts/158/tado-which-starter-kit-to-choose-presentation-and-comparison-600-679be727f.png 600w, https://haade.fr/assets/images/generated/posts/158/tado-which-starter-kit-to-choose-presentation-and-comparison-700-679be727f.png 700w, https://haade.fr/assets/images/generated/posts/158/tado-which-starter-kit-to-choose-presentation-and-comparison-800-679be727f.png 800w" type="image/png"> <img class="img-thumb lazyload" src="https://haade.fr/assets/images/generated/posts/158/tado-which-starter-kit-to-choose-presentation-and-comparison-800-679be727f.png" alt="Tado° which starter kit should I choose?" width="1200" height="675"> </picture> </a></div><div class="card-body"><h2 class="card-title"> <a class="text-dark" href="/en/blog/tado-which-starter-kit-to-choose-presentation-comparison-and-protocol">Tado° which starter kit should I choose?</a><div class="mb-2 mt-2 font-weight-normal"><div class="rating-holder"><div class="Stars" style="--rating: 4.8; --star-background: #FF6600" title="Rating of this product is 4.8 out of 5."></div></div></div></h2><p class="card-text">After presenting the sumptuous Tado° X thermostatic faucet, as well as the most successful Tado app, Now let’s get to the heart of the system. Today, I’m going to introduce...</p></div><div class="card-footer bg-white"><div class="wrapfooter"> <span class="meta-footer-thumb"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-40-5d88b8595.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-40-c8508425c.png 1.0x" type="image/png"> <img class="author-thumb" itemprop="image" width="40" height="40" src="https://haade.fr/assets/images/generated/nico-40-c8508425c.png" alt="Nico"> </picture> </span> <span class="author-meta"> <a href="/en/author-nico"><span class="post-name font-weight-bold">Nico</span></a> <span class="post-date">19<sup>th</sup>March 2025</span> </span><div class="clearfix"></div></div></div></div></div><div class="blog-grid-item"><div class="card h-100"><div class="maxthumb"> <a href="/en/blog/zigbee-automation-of-shutters-tradi-id-bubendorff"><picture> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/157/domotise-test-rolling-shutters-bubendorff-in-zigbee-for-cheap-300-b542db3ae.webp 300w, https://haade.fr/assets/images/generated/posts/157/domotise-test-rolling-shutters-bubendorff-in-zigbee-for-cheap-400-b542db3ae.webp 400w, https://haade.fr/assets/images/generated/posts/157/domotise-test-rolling-shutters-bubendorff-in-zigbee-for-cheap-500-b542db3ae.webp 500w, https://haade.fr/assets/images/generated/posts/157/domotise-test-rolling-shutters-bubendorff-in-zigbee-for-cheap-600-b542db3ae.webp 600w, https://haade.fr/assets/images/generated/posts/157/domotise-test-rolling-shutters-bubendorff-in-zigbee-for-cheap-700-b542db3ae.webp 700w, https://haade.fr/assets/images/generated/posts/157/domotise-test-rolling-shutters-bubendorff-in-zigbee-for-cheap-800-b542db3ae.webp 800w" type="image/webp"> <source sizes="(max-width: 480px) calc(100vw - 30px), (max-width: 768px) calc(100vw - 30px), (max-width: 1024px) calc(50vw - 15px), (min-width: 1025px) 25vw, calc(100vw - 30px)" srcset="https://haade.fr/assets/images/generated/posts/157/domotise-test-rolling-shutters-bubendorff-in-zigbee-for-cheap-300-b542db3ae.png 300w, https://haade.fr/assets/images/generated/posts/157/domotise-test-rolling-shutters-bubendorff-in-zigbee-for-cheap-400-b542db3ae.png 400w, https://haade.fr/assets/images/generated/posts/157/domotise-test-rolling-shutters-bubendorff-in-zigbee-for-cheap-500-b542db3ae.png 500w, https://haade.fr/assets/images/generated/posts/157/domotise-test-rolling-shutters-bubendorff-in-zigbee-for-cheap-600-b542db3ae.png 600w, https://haade.fr/assets/images/generated/posts/157/domotise-test-rolling-shutters-bubendorff-in-zigbee-for-cheap-700-b542db3ae.png 700w, https://haade.fr/assets/images/generated/posts/157/domotise-test-rolling-shutters-bubendorff-in-zigbee-for-cheap-800-b542db3ae.png 800w" type="image/png"> <img class="img-thumb lazyload" src="https://haade.fr/assets/images/generated/posts/157/domotise-test-rolling-shutters-bubendorff-in-zigbee-for-cheap-800-b542db3ae.png" alt="Automate Bubendorff roller shutters in Zigbee for cheap" width="1200" height="675"> </picture> </a></div><div class="card-body"><h2 class="card-title"> <a class="text-dark" href="/en/blog/zigbee-automation-of-shutters-tradi-id-bubendorff">Automate Bubendorff roller shutters in Zigbee for cheap</a></h2><p class="card-text">Today I’m not explaining to you how I automated Bubendorff shutters in Zigbee, simply because it’s not possible, but why I decided to remove the Bubendorff Tradi ID 1 system...</p></div><div class="card-footer bg-white"><div class="wrapfooter"> <span class="meta-footer-thumb"><picture> <source srcset="https://haade.fr/assets/images/generated/nico-40-5d88b8595.webp 1.0x" type="image/webp"> <source srcset="https://haade.fr/assets/images/generated/nico-40-c8508425c.png 1.0x" type="image/png"> <img class="author-thumb" itemprop="image" width="40" height="40" src="https://haade.fr/assets/images/generated/nico-40-c8508425c.png" alt="Nico"> </picture> </span> <span class="author-meta"> <a href="/en/author-nico"><span class="post-name font-weight-bold">Nico</span></a> <span class="post-date">11<sup>th</sup>March 2025</span> </span><div class="clearfix"></div></div></div></div></div></div></div></div></div><footer><div class="footcontent"><div class="footleft footbox"><div class="footupper"><div class="foottopic">About</div><p>Haade is a blog intended to help individuals and professionals to set up a home automation system</p></div><div class="footlower"><div class="foottopic">Contact-us</div><div class="phone"> <a href="#"><i class="icos phone-volume-solid"></i>+0033 6 99 40 15 86</a></div><div class="email"> <a href="/en/contact"><i class="icos envelope-solid"></i>Confact form</a></div></div></div><div class="footmiddle footbox"><div class="foottopic">Useful links</div><div><a href="/en/gdpr-general-data-protection-regulation">Privacy Policy</a></div><div><a href="/en/legal-notice">Legal notice</a></div><div><a target="_blank" href="https://buildwithmatter.com/">Protocole Matter</a></div><div><a target="_blank" href="https://zigbeealliance.org/fr/%C3%A9v%C3%A9nements/">Zigbee Alliance</a></div><div><a target="_blank" href="https://z-wavealliance.org/category/z-wave-in-the-news/">Z-wave Alliance</a></div><div><a target="_blank" href="https://www.aqara.com/eu/news.html">Aquara by Xiaomi</a></div><div><a target="_blank" href="https://itead.cc/">Itead Sonoff, Nextion</a></div></div><div class="footright footbox"><div class="foottopic">Subscribe to the newsletter</div><form action="https://haade.us4.list-manage.com/subscribe/post?u=86f32891957737a57c0b4ade8&amp;id=92dadba2b4&amp;f_id=00639cebf0" method="post" name="embedded-mail" target="_blank"> <input type="email" placeholder="Enter email address" name="EMAIL"> <input type="submit" name="Subscription" value="Send" id="submit"> </form> <a href="https://github.com/haade-administrator/haade.fr/discussions" target="_blank" alt="github discussion link" aria-label="Continue the discussion on the github forum"><i class="icob github" aria-hidden="true" title="github discussion"></i></a> <a target="_blank" href="https://www.youtube.com/channel/UCcXJ1ZsjEvQxuWJy7gH-A6w/?sub_confirmation=1" onclick="window.open(this.href, 'width=550,height=435');return false;" aria-label="Subscribe to our youtube channel"><i class="icob youtube" aria-hidden="true" title="youtube"></i></a> <a target="_blank" href="https://discord.gg/FaK6MuZ2" onclick="window.open(this.href, 'width=550,height=435');return false;" aria-label="Invitation to our Discord network"><i class="icob discord" aria-hidden="true" title="discord"></i></a> <a href="/en/feed.xml" target="_blank" alt="feed rss" aria-label="share the rss feed with your friends"><i class="icob rss" aria-hidden="true" title="feed rss haade"></i></a></div></div></div><div class="footbottom"><p>Copyright © 2025 <a target="_blank" href="https://www.haade.fr">Haade</a> 🎉 by Nicoxygen</p></div></footer></div><script src="/assets/js/main.min.js?v=a0225e1608e525477f5b4a4ae3f3425c" type="text/javascript"></script> <script src="/assets/js/lunrsearchengine-en.js?v=6debdc48922f8918a8d9a7cf53f61883"></script>
